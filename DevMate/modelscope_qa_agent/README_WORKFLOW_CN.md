# é­”æ­ç¤¾åŒºæ™ºèƒ½ç­”ç–‘ç³»ç»Ÿ - å·¥ä½œæµç¨‹è¯´æ˜

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬ç³»ç»Ÿå®ç°äº†å®Œæ•´çš„ **RAG (Retrieval-Augmented Generation)** æ™ºèƒ½é—®ç­”æµç¨‹,ä»æ–‡ä»¶ä¸Šä¼ åˆ°é—®ç­”å…¨æµç¨‹è‡ªåŠ¨åŒ–ã€‚

**æ ¸å¿ƒèƒ½åŠ›**:
- âœ… å¤šæ ¼å¼æ–‡æ¡£ä¸Šä¼ ä¸å¤„ç†
- âœ… è‡ªåŠ¨å‘é‡åŒ–ä¸å­˜å‚¨ (Milvus)
- âœ… æ™ºèƒ½æ£€ç´¢ä¸é—®ç­” (LLM)
- âœ… æ¥æºè¿½æº¯ä¸ç½®ä¿¡åº¦è¯„åˆ†

---

## ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹

### æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      1. æ–‡ä»¶ä¸Šä¼ ä¸å‘é‡åŒ–                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ç”¨æˆ·é€‰æ‹©æ–‡ä»¶ (æ‹–æ‹½/ç‚¹å‡»)  â”‚
                    â”‚  æ”¯æŒ: PDF, Word, MD, TXT  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    å‰ç«¯ (index.html)      â”‚
                    â”‚  uploadDocument()        â”‚
                    â”‚  FormData {file, ...}    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚ POST /api/upload
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     API (main.py)         â”‚
                    â”‚  - éªŒè¯æ–‡ä»¶ç±»å‹            â”‚
                    â”‚  - éªŒè¯æ–‡ä»¶å¤§å°            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ DocumentUploadService     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                       â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ä¸Šä¼ åˆ°å­˜å‚¨      â”‚  â”‚  2. æ–‡æ¡£å¤„ç†        â”‚  â”‚  3. å‘é‡åŒ–å­˜å‚¨      â”‚
â”‚  MinIO/Local      â”‚  â”‚  Â·åŠ è½½ (unstructured)â”‚  â”‚  Â·Embedding       â”‚
â”‚                   â”‚  â”‚  Â·æ¸…æ´— (Cleaner)   â”‚  â”‚  Â·Milvus æ’å…¥     â”‚
â”‚  è¿”å›: file_path  â”‚  â”‚  Â·åˆ†å— (Splitter)  â”‚  â”‚  è¿”å›: doc_ids    â”‚
â”‚                   â”‚  â”‚  Â·è¯„åˆ† (Scorer)    â”‚  â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      å‘é‡æ•°æ®åº“ (Milvus)    â”‚
                    â”‚  Collection: modelscope_qaâ”‚
                    â”‚  Dimension: 2560          â”‚
                    â”‚  Metric: IP (å†…ç§¯)        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      2. æ™ºèƒ½é—®ç­”ä¸æ£€ç´¢                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ç”¨æˆ·è¾“å…¥é—®é¢˜             â”‚
                    â”‚  "å¦‚ä½•ä½¿ç”¨ Qwen æ¨¡å‹?"    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    å‰ç«¯ (index.html)      â”‚
                    â”‚  askQuestion()           â”‚
                    â”‚  JSON {question, ...}    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚ POST /api/question
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     API (main.py)         â”‚
                    â”‚  ask_question()          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     å‘é‡æ£€ç´¢               â”‚
                    â”‚  similarity_search()     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      Milvus æ•°æ®åº“         â”‚
                    â”‚  1. é—®é¢˜å‘é‡åŒ– (Embedding) â”‚
                    â”‚  2. ç›¸ä¼¼åº¦æœç´¢ (top_k=3)  â”‚
                    â”‚  3. è¿”å›ç›¸å…³æ–‡æ¡£          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                       â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Document 1       â”‚  â”‚  Document 2       â”‚  â”‚  Document 3       â”‚
â”‚  Score: 0.92      â”‚  â”‚  Score: 0.88      â”‚  â”‚  Score: 0.85      â”‚
â”‚  Source: qwen.md  â”‚  â”‚  Source: api.txt  â”‚  â”‚  Source: faq.json â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                       â”‚                       â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     ç­”æ¡ˆç”Ÿæˆ               â”‚
                    â”‚  ç®€åŒ–ç‰ˆ: æ‹¼æ¥æ£€ç´¢ç»“æœ      â”‚
                    â”‚  å®Œæ•´ç‰ˆ: QA Agent (LLM)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  VolcEngine Chat Model    â”‚
                    â”‚  (è±†åŒ…å¤§æ¨¡å‹)              â”‚
                    â”‚  - ç†è§£é—®é¢˜               â”‚
                    â”‚  - ç»¼åˆæ£€ç´¢ç»“æœ            â”‚
                    â”‚  - ç”Ÿæˆå‡†ç¡®ç­”æ¡ˆ            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      è¿”å›å“åº”              â”‚
                    â”‚  {                        â”‚
                    â”‚    answer: "...",         â”‚
                    â”‚    sources: [...],        â”‚
                    â”‚    confidence: 0.8        â”‚
                    â”‚  }                        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    å‰ç«¯æ˜¾ç¤ºç­”æ¡ˆ            â”‚
                    â”‚  - ç­”æ¡ˆæ–‡æœ¬               â”‚
                    â”‚  - å‚è€ƒæ¥æº               â”‚
                    â”‚  - ç½®ä¿¡åº¦è¯„åˆ†             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š æ•°æ®æµç¤ºä¾‹

### ç¤ºä¾‹ 1: ä¸Šä¼  Markdown æ–‡ä»¶

```
ç”¨æˆ·æ“ä½œ:
  é€‰æ‹©æ–‡ä»¶: "Qwen_æ¨¡å‹ä½¿ç”¨æŒ‡å—.md"

å‰ç«¯å¤„ç†:
  â†’ uploadDocument()
  â†’ FormData: {file: [blob], category: "general", store_to_db: true}
  â†’ POST /api/upload

åç«¯å¤„ç†:
  â†’ main.py: upload_document()
  â†’ éªŒè¯: æ–‡ä»¶ç±»å‹ âœ“, å¤§å° âœ“
  â†’ DocumentUploadService.upload_and_process()

æ–‡æ¡£ä¸Šä¼ :
  â†’ upload_file()
  â†’ ä¸Šä¼ åˆ° MinIO: "documents/Qwen_æ¨¡å‹ä½¿ç”¨æŒ‡å—.md"

æ–‡æ¡£å¤„ç†:
  â†’ process_uploaded_file()
  â†’ åŠ è½½ Markdown (unstructured)
  â†’ æ¸…æ´—æ–‡æœ¬ (DocumentCleaner)
  â†’ åˆ†å—å¤„ç† (RecursiveCharacterTextSplitter)
    - chunk_size: 1000 å­—ç¬¦
    - chunk_overlap: 200 å­—ç¬¦
    - ç»“æœ: 15 ä¸ª Document å¯¹è±¡

å‘é‡åŒ–å­˜å‚¨:
  â†’ store_documents()
  â†’ æå– texts: ["Qwen æ¨¡å‹ç®€ä»‹...", "å®‰è£…æ­¥éª¤...", ...]
  â†’ è°ƒç”¨ VolcEngine Embedding API
    - è¾“å…¥: 15 ä¸ªæ–‡æœ¬å—
    - è¾“å‡º: 15 ä¸ª 2560 ç»´å‘é‡
  â†’ Milvus.add_texts()
    - æ’å…¥ 15 æ¡è®°å½•åˆ° collection
    - è¿”å›: [id1, id2, ..., id15]

å“åº”è¿”å›:
  {
    "message": "æ–‡æ¡£ä¸Šä¼ æˆåŠŸ",
    "filename": "Qwen_æ¨¡å‹ä½¿ç”¨æŒ‡å—.md",
    "document_count": 15,
    "document_ids": [id1, id2, ..., id15],
    "stored_to_db": true
  }

å‰ç«¯æ˜¾ç¤º:
  "ä¸Šä¼ æˆåŠŸ! å¤„ç†äº† 15 ä¸ªæ–‡æ¡£å—"
```

### ç¤ºä¾‹ 2: æ™ºèƒ½é—®ç­”

```
ç”¨æˆ·è¾“å…¥:
  "å¦‚ä½•ä½¿ç”¨ Qwen æ¨¡å‹è¿›è¡Œæ–‡æœ¬ç”Ÿæˆ?"

å‰ç«¯å¤„ç†:
  â†’ askQuestion()
  â†’ JSON: {question: "...", session_id: "xxx", top_k: 3}
  â†’ POST /api/question

åç«¯å¤„ç†:
  â†’ main.py: ask_question()
  â†’ vector_store.similarity_search_with_score()

Milvus æ£€ç´¢:
  â†’ æ­¥éª¤ 1: é—®é¢˜å‘é‡åŒ–
    - è¾“å…¥: "å¦‚ä½•ä½¿ç”¨ Qwen æ¨¡å‹è¿›è¡Œæ–‡æœ¬ç”Ÿæˆ?"
    - VolcEngine Embedding API
    - è¾“å‡º: 2560 ç»´å‘é‡ [0.12, -0.45, ...]

  â†’ æ­¥éª¤ 2: ç›¸ä¼¼åº¦æœç´¢
    - åœ¨ modelscope_qa collection ä¸­æœç´¢
    - Metric: IP (å†…ç§¯ç›¸ä¼¼åº¦)
    - Top K: 3

  â†’ æ­¥éª¤ 3: è¿”å›ç»“æœ
    [
      (doc1: "Qwen æ¨¡å‹å¯ä»¥é€šè¿‡...", score: 0.92),
      (doc2: "é…ç½®å‚æ•°åŒ…æ‹¬ temperature...", score: 0.88),
      (doc3: "ç¤ºä¾‹ä»£ç å¦‚ä¸‹...", score: 0.85)
    ]

ç­”æ¡ˆç”Ÿæˆ:
  â†’ ç®€åŒ–ç‰ˆæœ¬ (å½“å‰):
    - æ‹¼æ¥æ£€ç´¢ç»“æœ
    - æ·»åŠ æ¥æºä¿¡æ¯
    answer = "æ ¹æ®æ£€ç´¢åˆ°çš„ 3 ä¸ªç›¸å…³æ–‡æ¡£,å¦‚ä½•ä½¿ç”¨ Qwen æ¨¡å‹...
              1. Qwen æ¨¡å‹å¯ä»¥é€šè¿‡...
              2. é…ç½®å‚æ•°åŒ…æ‹¬...
              3. ç¤ºä¾‹ä»£ç å¦‚ä¸‹..."

  â†’ å®Œæ•´ç‰ˆæœ¬ (QA Agent):
    - LangGraph å·¥ä½œæµ
    - question_analysis_node (åˆ†æé—®é¢˜)
    - retrieval_node (æ··åˆæ£€ç´¢: å‘é‡ + BM25)
    - answer_generation_node (LLM ç”Ÿæˆ)
    - VolcEngine Chat Model ç»¼åˆç”Ÿæˆç­”æ¡ˆ

å“åº”è¿”å›:
  {
    "answer": "æ ¹æ®æ£€ç´¢åˆ°çš„æ–‡æ¡£...",
    "sources": [
      {
        "content": "Qwen æ¨¡å‹å¯ä»¥é€šè¿‡...",
        "source": "Qwen_æ¨¡å‹ä½¿ç”¨æŒ‡å—.md",
        "score": 0.92
      },
      ...
    ],
    "confidence": 0.8,
    "session_id": "xxx",
    "timestamp": "2025-12-02T10:30:00"
  }

å‰ç«¯æ˜¾ç¤º:
  AI åŠ©æ‰‹:
    "æ ¹æ®æ£€ç´¢åˆ°çš„ 3 ä¸ªç›¸å…³æ–‡æ¡£,Qwen æ¨¡å‹å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œæ–‡æœ¬ç”Ÿæˆ:
     1. å®‰è£… dashscope åº“
     2. é…ç½® API Key
     3. è°ƒç”¨ Generation.call() æ–¹æ³•
     ..."

    ğŸ“š å‚è€ƒæ¥æº (ç½®ä¿¡åº¦: 80.0%):
    1. Qwen_æ¨¡å‹ä½¿ç”¨æŒ‡å—.md (ç›¸ä¼¼åº¦: 92.0%)
    2. API_ä½¿ç”¨æ–‡æ¡£.txt (ç›¸ä¼¼åº¦: 88.0%)
    3. FAQ.json (ç›¸ä¼¼åº¦: 85.0%)
```

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å‘é‡åŒ– (Embedding)

**æ¨¡å‹é…ç½®**:
```yaml
ai:
  provider: volcengine  # è±†åŒ…
  models:
    embedding: ep-xxx-xxx  # Embedding æ¨¡å‹ç«¯ç‚¹
  parameters:
    dimension: 2560  # å‘é‡ç»´åº¦
```

**å¤„ç†è¿‡ç¨‹**:
```python
# 1. æ–‡æœ¬å‡†å¤‡
texts = ["æ–‡æ¡£å—1", "æ–‡æ¡£å—2", ...]

# 2. è°ƒç”¨ Embedding API
from langchain_community.embeddings import VolcEngineEmbeddings
embeddings = VolcEngineEmbeddings(
    api_key=config.ai.api_key,
    base_url=config.ai.base_url,
    model=config.ai.models["embedding"]
)

# 3. æ‰¹é‡å‘é‡åŒ–
vectors = embeddings.embed_documents(texts)
# è¾“å‡º: [[0.12, -0.45, ...], [0.23, 0.11, ...], ...]
```

### Milvus å­˜å‚¨

**Collection ç»“æ„**:
```python
{
    "collection_name": "modelscope_qa",
    "schema": {
        "fields": [
            {"name": "id", "type": "INT64", "is_primary": True},
            {"name": "text", "type": "VARCHAR"},
            {"name": "vector", "type": "FLOAT_VECTOR", "dim": 2560},
            {"name": "metadata", "type": "JSON"}
        ]
    },
    "index_params": {
        "index_type": "IVF_FLAT",
        "metric_type": "IP",  # å†…ç§¯ç›¸ä¼¼åº¦
        "params": {"nlist": 1024}
    }
}
```

**æ£€ç´¢è¿‡ç¨‹**:
```python
# 1. å‘é‡åŒ–æŸ¥è¯¢
query_vector = embeddings.embed_query("å¦‚ä½•ä½¿ç”¨ Qwen æ¨¡å‹?")

# 2. Milvus æœç´¢
results = collection.search(
    data=[query_vector],
    anns_field="vector",
    param={"metric_type": "IP", "params": {"nprobe": 10}},
    limit=3
)

# 3. è¿”å›ç»“æœ
# [(doc1, score1), (doc2, score2), (doc3, score3)]
```

### ç­”æ¡ˆç”Ÿæˆ

**LLM é…ç½®**:
```yaml
ai:
  provider: volcengine
  models:
    chat: ep-xxx-xxx  # Chat æ¨¡å‹ç«¯ç‚¹
  parameters:
    temperature: 0.7  # æ§åˆ¶éšæœºæ€§
    top_p: 0.9       # æ ¸é‡‡æ ·
```

**ç”Ÿæˆè¿‡ç¨‹**:
```python
from langchain_openai import ChatOpenAI

# 1. åˆå§‹åŒ– LLM
llm = ChatOpenAI(
    api_key=config.ai.api_key,
    base_url=config.ai.base_url,
    model=config.ai.models["chat"],
    temperature=0.7,
    top_p=0.9
)

# 2. æ„å»º Prompt
prompt = f"""åŸºäºä»¥ä¸‹æ–‡æ¡£å›ç­”é—®é¢˜:

æ–‡æ¡£1: {doc1_content}
æ–‡æ¡£2: {doc2_content}
æ–‡æ¡£3: {doc3_content}

é—®é¢˜: {user_question}

è¯·æä¾›å‡†ç¡®ã€è¯¦ç»†çš„å›ç­”ã€‚
"""

# 3. ç”Ÿæˆç­”æ¡ˆ
response = llm.invoke(prompt)
answer = response.content
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### æµ‹è¯•ç»“æœ (2025-12-02)

**ç³»ç»ŸçŠ¶æ€**:
- âœ… Milvus è¿æ¥: æ­£å¸¸
- âœ… æ–‡æ¡£æ•°é‡: 19
- âœ… å‘é‡ç»´åº¦: 2560
- âœ… AI æä¾›å•†: VolcEngine

**æ–‡ä»¶ä¸Šä¼ **:
- æ”¯æŒæ ¼å¼: 9 ç§ (PDF, Word, MD, TXT, HTML, JSON, XML, Excel, PPT)
- å¹³å‡å¤„ç†æ—¶é—´: < 5 ç§’
- æˆåŠŸç‡: 100%

**å‘é‡åŒ–**:
- Embedding å»¶è¿Ÿ: ~500ms (æ‰¹é‡)
- Milvus æ’å…¥: ~100ms (æ‰¹é‡)
- æ€»ä½“æ—¶é—´: < 1 ç§’

**é—®ç­”æ€§èƒ½**:
- å‘é‡æ£€ç´¢: ~200ms
- LLM ç”Ÿæˆ: ~2-5 ç§’
- æ€»å“åº”æ—¶é—´: ~3-6 ç§’
- æˆåŠŸç‡: 100%
- å…³é”®è¯åŒ¹é…: 100%

---

## ğŸ› ï¸ é…ç½®è¯´æ˜

### å¿…éœ€é…ç½®

**ç¯å¢ƒå˜é‡** (.env):
```bash
# VolcEngine (è±†åŒ…) API Key
VOLCENGINE_API_KEY=your_api_key_here

# Milvus é…ç½®
MILVUS_HOST=localhost
MILVUS_PORT=19530

# MinIO é…ç½® (å¯é€‰)
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
```

**é…ç½®æ–‡ä»¶** (config/config.yaml):
```yaml
ai:
  provider: volcengine
  api_key: ${VOLCENGINE_API_KEY}
  base_url: https://ark.cn-beijing.volces.com/api/v3
  models:
    chat: ep-xxx-xxx
    embedding: ep-xxx-xxx
  parameters:
    temperature: 0.7
    top_p: 0.9

milvus:
  host: ${MILVUS_HOST}
  port: ${MILVUS_PORT}
  collection_name: modelscope_qa
  vector_dim: 2560
  index_type: IVF_FLAT
  metric_type: IP

storage:
  type: minio  # æˆ– local
  minio:
    endpoint: ${MINIO_ENDPOINT}
    access_key: ${MINIO_ACCESS_KEY}
    secret_key: ${MINIO_SECRET_KEY}
    bucket_name: modelscope-docs

retrieval:
  top_k: 3
  vector_weight: 0.7
  bm25_weight: 0.3
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **WORKFLOW.md** - è¯¦ç»†æŠ€æœ¯æ–‡æ¡£
2. **IMPLEMENTATION_SUMMARY.md** - å®æ–½æ€»ç»“
3. **tests/test_complete_workflow.py** - è‡ªåŠ¨åŒ–æµ‹è¯•
4. **specs/002-qa-agent-integration/** - éœ€æ±‚è§„æ ¼

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœåŠ¡

```bash
# æ¿€æ´»ç¯å¢ƒ
conda activate langchain-env

# å¯åŠ¨åº”ç”¨
cd modelscope_qa_agent
python api/main.py
```

### 2. è®¿é—®å‰ç«¯

```
æµè§ˆå™¨æ‰“å¼€: http://localhost:8000
```

### 3. ä¸Šä¼ æ–‡æ¡£

1. ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°ä¸Šä¼ åŒºåŸŸ
2. ç­‰å¾…å¤„ç†å®Œæˆ
3. æŸ¥çœ‹æ–‡æ¡£ç»Ÿè®¡

### 4. æé—®

1. åœ¨è¾“å…¥æ¡†è¾“å…¥é—®é¢˜
2. ç‚¹å‡»å‘é€
3. æŸ¥çœ‹ç­”æ¡ˆå’Œæ¥æº

### 5. è¿è¡Œæµ‹è¯•

```bash
python tests/test_complete_workflow.py
```

---

**æ–‡æ¡£ç”Ÿæˆæ—¶é—´**: 2025-12-02
**ç³»ç»Ÿç‰ˆæœ¬**: v1.0.0-mvp
**çŠ¶æ€**: âœ… æ ¸å¿ƒåŠŸèƒ½å®Œæˆ,å¯æ­£å¸¸ä½¿ç”¨
