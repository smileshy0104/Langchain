# LangChain v1.0 å®Œæ•´æŒ‡å—

> é¢å‘ç”Ÿäº§ç¯å¢ƒçš„ AI Agent æ„å»ºæ¡†æ¶ - æ ¸å¿ƒå˜åŒ–ã€ä¼˜åŠ¿ä¸è¿ç§»æŒ‡å—

---

## ğŸ“‹ ç›®å½•

- [ç‰ˆæœ¬æ¦‚å†µ](#ç‰ˆæœ¬æ¦‚å†µ)
- [æ ¸å¿ƒè®¾è®¡ç†å¿µ](#æ ¸å¿ƒè®¾è®¡ç†å¿µ)  
- [æ¶æ„å±‚é¢çš„é‡å¤§å˜åŒ–](#æ¶æ„å±‚é¢çš„é‡å¤§å˜åŒ–)
- [åŠŸèƒ½å±‚é¢çš„æ ¸å¿ƒæ”¹è¿›](#åŠŸèƒ½å±‚é¢çš„æ ¸å¿ƒæ”¹è¿›)
- [ç”Ÿäº§å°±ç»ªæ€§æå‡](#ç”Ÿäº§å°±ç»ªæ€§æå‡)
- [ä¸»è¦ç ´åæ€§å˜æ›´](#ä¸»è¦ç ´åæ€§å˜æ›´)
- [æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“](#æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“)
- [è®¾è®¡å“²å­¦æ¼”å˜](#è®¾è®¡å“²å­¦æ¼”å˜)
- [è¿ç§»æŒ‡å—](#è¿ç§»æŒ‡å—)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å‚è€ƒèµ„æº](#å‚è€ƒèµ„æº)

---

## ç‰ˆæœ¬æ¦‚å†µ

| é¡¹ç›® | å†…å®¹ |
|------|------|
| **å‘å¸ƒæ—¶é—´** | 2025å¹´10æœˆ20æ—¥ |
| **ç‰ˆæœ¬å·** | v1.0.0 |
| **å®šä½** | é¢å‘ç”Ÿäº§ç¯å¢ƒçš„ Agent æ„å»ºåŸºç¡€æ¡†æ¶ |
| **æ ¸å¿ƒç†å¿µ** | æœ€ç®€å•çš„ LLM åº”ç”¨èµ·ç‚¹ï¼ŒåŒæ—¶å…¼å…·çµæ´»æ€§å’Œç”Ÿäº§å°±ç»ªèƒ½åŠ› |
| **ç¨³å®šæ€§æ‰¿è¯º** | åœ¨ 2.0 ä¹‹å‰æ— ç ´åæ€§å˜æ›´ |
| **é‡‡ç”¨ä¼ä¸š** | Uberã€LinkedInã€Klarna ç­‰ |

---

## æ ¸å¿ƒè®¾è®¡ç†å¿µ

LangChain v1.0 æ„å»ºåœ¨ä»¥ä¸‹æ ¸å¿ƒä¿¡å¿µä¹‹ä¸Šï¼š

### 1. æ•°æ®èåˆæ˜¯å…³é”®
> LLM ä¸å¤–éƒ¨æ•°æ®æºç»“åˆæ—¶æœ€å…·å˜é©æ€§

- æ”¯æŒå¤šç§æ•°æ®æºé›†æˆ
- æ ‡å‡†åŒ–çš„æ•°æ®è®¿é—®æ¥å£
- é«˜æ•ˆçš„æ•°æ®æ£€ç´¢å’Œå¤„ç†

### 2. Agent åŒ–æ˜¯è¶‹åŠ¿
> æœªæ¥åº”ç”¨å°†è¶Šæ¥è¶Š Agent åŒ–

- è‡ªä¸»å†³ç­–èƒ½åŠ›
- åŠ¨æ€å·¥å…·è°ƒç”¨
- ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„è¡Œä¸º

### 3. ç”Ÿäº§å¯é æ€§æŒ‘æˆ˜
> å°½ç®¡åŸå‹å¼€å‘å®¹æ˜“ï¼Œä½†æ„å»ºå¯é çš„ç”Ÿäº§çº§ Agent ä»å…·æŒ‘æˆ˜æ€§

- æŒä¹…åŒ–æ‰§è¡Œæœºåˆ¶
- é”™è¯¯å¤„ç†å’Œæ¢å¤
- çŠ¶æ€ç®¡ç†å’Œæ£€æŸ¥ç‚¹

### 4. ç¼–æ’ä¼˜å…ˆäºç”Ÿæˆ
> æ¨¡å‹åº”ç¼–æ’å¤æ‚æµç¨‹ï¼Œè€Œéä»…ç”Ÿæˆæ–‡æœ¬

- å·¥ä½œæµç¼–æ’èƒ½åŠ›
- å¤šæ­¥éª¤ä»»åŠ¡æ‰§è¡Œ
- ç¡®å®šæ€§ä¸ Agent åŒ–çš„ç»“åˆ

---

## æ¶æ„å±‚é¢çš„é‡å¤§å˜åŒ–

### 1. ç»Ÿä¸€çš„ Agent æŠ½è±¡ ğŸ¯

#### æ ¸å¿ƒå˜åŒ–
- **æ—§æ¶æ„**: å¤šç§ chains å’Œ agentsï¼ˆConversationalRetrievalChainã€ReActAgent ç­‰ï¼‰
- **æ–°æ¶æ„**: å•ä¸€çš„é«˜å±‚æŠ½è±¡ - åŸºäº LangGraph æ„å»ºçš„ç»Ÿä¸€ Agent

#### æ–° API: `create_agent`

**æ›¿ä»£å…³ç³»**:
```python
# âŒ æ—§æ–¹å¼ (å·²å¼ƒç”¨)
from langgraph.prebuilt import create_react_agent

# âœ… æ–°æ–¹å¼ (v1.0 æ¨è)
from langchain.agents import create_agent
```

**æ ¸å¿ƒç‰¹æ€§**:
- æ›´æ¸…æ™°ã€æ›´å¼ºå¤§çš„ API æ¥å£
- 10 è¡Œä»£ç å†…æ„å»ºåŸºç¡€ Agent
- æ”¯æŒé€šè¿‡ä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰è¿›è¡Œæ·±åº¦è‡ªå®šä¹‰
- å†…ç½®å·¥å…·è°ƒç”¨ã€çŠ¶æ€ç®¡ç†ã€é”™è¯¯å¤„ç†

**åŸºç¡€ç¤ºä¾‹**:
```python
from langchain.agents import create_agent
from langchain_anthropic import ChatAnthropic

# å®šä¹‰å·¥å…·
def get_weather(location: str) -> str:
    """è·å–æŒ‡å®šä½ç½®çš„å¤©æ°”ä¿¡æ¯"""
    return f"{location} çš„å¤©æ°”æ˜¯æ™´æœ—çš„"

# åˆ›å»º Agentï¼ˆå°‘äº 10 è¡Œä»£ç ï¼‰
model = ChatAnthropic(model="claude-3-5-sonnet-20241022")
agent = create_agent(
    model=model,
    tools=[get_weather],
    system_prompt="ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„ AI åŠ©æ‰‹"
)

# æ‰§è¡Œ
result = agent.invoke({"messages": [{"role": "user", "content": "åŒ—äº¬å¤©æ°”å¦‚ä½•ï¼Ÿ"}]})
```

### 2. ç®€åŒ–çš„åŒ…ç»“æ„ ğŸ“¦

#### å‘½åç©ºé—´ç²¾ç®€

**æ ¸å¿ƒåŸåˆ™**: `langchain` åŒ…èšç„¦äº Agent æ„å»ºçš„æ ¸å¿ƒç»„ä»¶

**åŒ…ç»“æ„å˜åŒ–**:

| åŠŸèƒ½æ¨¡å— | v0.x ä½ç½® | v1.0 ä½ç½® |
|---------|----------|----------|
| Agent åˆ›å»º | `langchain.agents` | `langchain.agents` âœ… |
| æ¨¡å‹é›†æˆ | `langchain.chat_models` | `langchain_*` (ç‹¬ç«‹åŒ…) |
| Retrievers | `langchain.retrievers` | `langchain-classic` |
| Embeddings | `langchain.embeddings` | `langchain-classic` |
| Chains | `langchain.chains` | `langchain-classic` |
| Indexing | `langchain.indexes` | `langchain-classic` |
| Hub | `langchain.hub` | `langchain-classic` |

**ä¼˜åŠ¿**:
- âœ… æ›´å®¹æ˜“å‘ç°æ ¸å¿ƒåŠŸèƒ½
- âœ… å‡å°‘å­¦ä¹ æ›²çº¿
- âœ… æ›´æ¸…æ™°çš„ä¾èµ–å…³ç³»
- âœ… æ›´å°çš„åŒ…ä½“ç§¯

### 3. æ·±åº¦é›†æˆ LangGraph ğŸ”—

#### åŒå±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      LangChain v1.0 (é«˜å±‚æŠ½è±¡)       â”‚
â”‚   - create_agent                    â”‚
â”‚   - ç®€å•æ˜“ç”¨ï¼ˆ<10 è¡Œä»£ç ï¼‰            â”‚
â”‚   - å¿«é€ŸåŸå‹å¼€å‘                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ æ„å»ºåœ¨
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      LangGraph v1.0 (åº•å±‚è¿è¡Œæ—¶)     â”‚
â”‚   - å›¾åŸè¯­ï¼ˆçŠ¶æ€ã€èŠ‚ç‚¹ã€è¾¹ï¼‰          â”‚
â”‚   - æŒä¹…åŒ–æ‰§è¡Œ                       â”‚
â”‚   - ç²¾ç»†æ§åˆ¶                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### LangGraph v1.0 æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ | åº”ç”¨åœºæ™¯ |
|-----|------|---------|
| **æŒä¹…åŒ–æ‰§è¡Œ** | çŠ¶æ€è‡ªåŠ¨ä¿å­˜å’Œæ¢å¤ | é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ |
| **æ£€æŸ¥ç‚¹** | ä»»æ„æ—¶åˆ»ä¿å­˜/åŠ è½½çŠ¶æ€ | é”™è¯¯æ¢å¤ã€è°ƒè¯• |
| **æµå¼å¤„ç†** | å®æ—¶è¾“å‡ºä¸­é—´ç»“æœ | äº¤äº’å¼åº”ç”¨ |
| **äººæœºåä½œ** | æš‚åœç­‰å¾…äººå·¥è¾“å…¥ | å®¡æ‰¹æµç¨‹ã€å¤æ‚å†³ç­– |
| **ç¨³å®š API** | å›¾åŸè¯­ä¿æŒä¸å˜ | é•¿æœŸç»´æŠ¤çš„é¡¹ç›® |

---

## åŠŸèƒ½å±‚é¢çš„æ ¸å¿ƒæ”¹è¿›

### 1. æ ‡å‡†åŒ–çš„å†…å®¹å—ï¼ˆContent Blocksï¼‰ ğŸ“

#### èƒŒæ™¯é—®é¢˜

**æ¨¡å‹ API æ¼”å˜**:
- **æ—©æœŸ**: ç®€å•çš„æ–‡æœ¬å­—ç¬¦ä¸²è¾“å‡º
- **ç°åœ¨**: å¤æ‚çš„ç»“æ„åŒ–è¾“å‡ºï¼ˆæ¨ç†ã€å¼•ç”¨ã€å·¥å…·è°ƒç”¨ç­‰ï¼‰
- **é—®é¢˜**: ä¸åŒæä¾›å•†æ ¼å¼ä¸ä¸€è‡´

#### v1.0 è§£å†³æ–¹æ¡ˆ

**æ–°å±æ€§**: `content_blocks`

**ç‰¹æ€§**:
- âœ… ç»Ÿä¸€è®¿é—®ç°ä»£ LLM ç‰¹æ€§
- âœ… å“åº”ä¸å†æ˜¯ä¸é€æ˜å­—ç¬¦ä¸²
- âœ… ç»“æ„åŒ–çš„å†…å®¹åˆ†ç±»
- âœ… è·¨æä¾›å•†æ ‡å‡†åŒ–

**æ”¯æŒçš„å†…å®¹ç±»å‹**:
- æ–‡æœ¬ï¼ˆtextï¼‰
- æ¨ç†è¿‡ç¨‹ï¼ˆreasoningï¼‰
- å¼•ç”¨ï¼ˆcitationï¼‰
- å·¥å…·è°ƒç”¨ï¼ˆtool_callï¼‰
- å¤šæ¨¡æ€è¾“å…¥ï¼ˆæ–‡ä»¶ã€å›¾åƒã€è§†é¢‘ç­‰ï¼‰

### 2. å¢å¼ºçš„ç»“æ„åŒ–è¾“å‡º ğŸ¯

#### æ”¹è¿›æ–¹æ¡ˆ

**æ—§æ–¹å¼**: ä¸¤æ­¥æµç¨‹
1. Agent ç”Ÿæˆå“åº”
2. é¢å¤– LLM è°ƒç”¨æå–ç»“æ„åŒ–æ•°æ®

**æ–°æ–¹å¼**: é›†æˆåˆ°ä¸»å¾ªç¯
- å°†ç»“æ„åŒ–è¾“å‡ºç”Ÿæˆé›†æˆåˆ°ä¸»æ¨¡å‹-å·¥å…·å¾ªç¯
- å‡å°‘é¢å¤–çš„ LLM è°ƒç”¨
- é™ä½å»¶è¿Ÿå’Œæˆæœ¬

**ä¼˜åŠ¿**:
- âš¡ æ›´ä½å»¶è¿Ÿï¼ˆå‡å°‘ LLM è°ƒç”¨ï¼‰
- ğŸ’° æ›´ä½æˆæœ¬ï¼ˆå‡å°‘ token ä½¿ç”¨ï¼‰
- ğŸ¯ æ›´é«˜å‡†ç¡®æ€§ï¼ˆæ¨¡å‹ç›´æ¥ç”Ÿæˆç»“æ„åŒ–æ•°æ®ï¼‰

### 3. ä¸­é—´ä»¶ç³»ç»Ÿï¼ˆMiddlewareï¼‰ ğŸ”§

#### æ¦‚è¿°

**æ–°åŠŸèƒ½**: å¯åœ¨æ¨¡å‹è°ƒç”¨ã€å·¥å…·è°ƒç”¨å‘¨å›´ç»„åˆä¸­é—´ä»¶

**æ ¸å¿ƒä»·å€¼**:
- æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆæ—¥å¿—ã€ç›‘æ§ã€é”™è¯¯å¤„ç†ï¼‰
- åŠ¨æ€è¡Œä¸ºæ³¨å…¥
- å¯å¤ç”¨çš„é€»è¾‘ç»„ä»¶

#### æ”¯æŒçš„é’©å­

```python
from langchain.agents import Middleware

class CustomMiddleware(Middleware):
    """è‡ªå®šä¹‰ä¸­é—´ä»¶ç¤ºä¾‹"""

    def before_model(self, state, config):
        """æ¨¡å‹è°ƒç”¨å‰æ‰§è¡Œ"""
        print(f"å‡†å¤‡è°ƒç”¨æ¨¡å‹ï¼Œå½“å‰çŠ¶æ€: {state}")
        return state

    def after_model(self, state, response, config):
        """æ¨¡å‹è°ƒç”¨åæ‰§è¡Œ"""
        print(f"æ¨¡å‹è°ƒç”¨å®Œæˆ")
        return response

    def wrap_tool_call(self, tool_call, state, config):
        """åŒ…è£…å·¥å…·è°ƒç”¨"""
        try:
            result = tool_call()
            return result
        except Exception as e:
            print(f"å·¥å…·è°ƒç”¨å¤±è´¥: {e}")
            return {"error": str(e)}
```

### 4. æ ‡å‡†åŒ–çš„æ¨¡å‹æ¥å£ ğŸ”Œ

#### æ ¸å¿ƒé—®é¢˜

**æä¾›å•†å·®å¼‚**:
- OpenAI: `chat.completions.create()`
- Anthropic: `messages.create()`
- Google: `generateContent()`
- ä¸åŒçš„å‚æ•°åã€å“åº”æ ¼å¼

#### LangChain ç»Ÿä¸€æ–¹æ¡ˆ

**ç»Ÿä¸€ API**:
```python
from langchain_openai import ChatOpenAI
from langchain_anthropic import ChatAnthropic
from langchain_google_genai import ChatGoogleGenerativeAI

# æ‰€æœ‰æ¨¡å‹ä½¿ç”¨ç›¸åŒæ¥å£
models = [
    ChatOpenAI(model="gpt-4"),
    ChatAnthropic(model="claude-3-5-sonnet-20241022"),
    ChatGoogleGenerativeAI(model="gemini-pro")
]

for model in models:
    # ç»Ÿä¸€çš„è°ƒç”¨æ–¹å¼
    response = model.invoke([
        {"role": "system", "content": "ä½ æ˜¯åŠ©æ‰‹"},
        {"role": "user", "content": "ä½ å¥½"}
    ])
    print(response.content)  # ç»Ÿä¸€çš„å“åº”æ ¼å¼
```

---

## ç”Ÿäº§å°±ç»ªæ€§æå‡

### 1. ç¨³å®šæ€§æ‰¿è¯º ğŸ›¡ï¸

#### ç‰ˆæœ¬ç­–ç•¥

**æ‰¿è¯º**:
- âœ… åœ¨ 2.0 ä¹‹å‰æ— ç ´åæ€§å˜æ›´
- âœ… å…¬å…± API ä¿æŒç¨³å®š
- âœ… å¼ƒç”¨å‰æœ‰å……åˆ†é€šçŸ¥

**å‘å¸ƒèŠ‚å¥**:
- ğŸ—“ï¸ Minor ç‰ˆæœ¬: æ¯ 2-3 ä¸ªæœˆ
- ğŸ› Patch ç‰ˆæœ¬: æŒ‰éœ€å‘å¸ƒ
- ğŸ“¢ Major ç‰ˆæœ¬: æå‰è‡³å°‘ 6 ä¸ªæœˆé€šçŸ¥

### 2. è°ƒè¯•å¢å¼º ğŸ”

#### LangSmith æ·±åº¦é›†æˆ

**æ ¸å¿ƒåŠŸèƒ½**:

**1. æ‰§è¡Œè¿½è¸ª**
```python
import os
os.environ["LANGCHAIN_TRACING_V2"] = "true"
os.environ["LANGCHAIN_API_KEY"] = "your-api-key"

# è‡ªåŠ¨è¿½è¸ªæ‰€æœ‰æ‰§è¡Œ
agent.invoke({"messages": [...]})

# åœ¨ LangSmith UI æŸ¥çœ‹:
# - æ¯ä¸€æ­¥çš„è¾“å…¥è¾“å‡º
# - å·¥å…·è°ƒç”¨è¯¦æƒ…
# - æ¨¡å‹æ¨ç†æ—¶é—´
# - Token ä½¿ç”¨ç»Ÿè®¡
```

**2. çŠ¶æ€å¯è§†åŒ–**
- å›¾å½¢åŒ–å±•ç¤º Agent æ‰§è¡Œæµç¨‹
- èŠ‚ç‚¹é—´çš„æ•°æ®æµå‘
- æ¡ä»¶åˆ†æ”¯çš„å†³ç­–è·¯å¾„

### 3. æ–‡æ¡£é‡æ„ ğŸ“š

#### æ–°æ–‡æ¡£ç«™ç‚¹ç‰¹æ€§

**å¯¼èˆªä¼˜åŒ–**:
- ğŸ§­ ç›´è§‚çš„åˆ†ç±»ç»“æ„
- ğŸ” å¼ºå¤§çš„æœç´¢åŠŸèƒ½
- ğŸ·ï¸ æ ‡ç­¾å’Œè¿‡æ»¤å™¨

**å†…å®¹æ”¹è¿›**:
- ğŸ“– æ·±å…¥çš„æ¦‚å¿µæŒ‡å—
- ğŸ’» å¯è¿è¡Œçš„ä»£ç ç¤ºä¾‹
- ğŸ“ ç«¯åˆ°ç«¯æ•™ç¨‹
- ğŸ—ï¸ å¸¸è§æ¶æ„æ¨¡å¼

---

## ä¸»è¦ç ´åæ€§å˜æ›´

### 1. å·²å¼ƒç”¨æ–¹æ³•ç§»é™¤ âŒ

#### ç§»é™¤åˆ—è¡¨

| ç§»é™¤é¡¹ | å¼ƒç”¨äº | æ›¿ä»£æ–¹æ¡ˆ |
|-------|-------|---------|
| `AgentExecutor` | v0.2 | `create_agent` |
| `LLMChain` | v0.1 | ç›´æ¥ä½¿ç”¨æ¨¡å‹ |
| `ConversationalRetrievalChain` | v0.2 | è‡ªå®šä¹‰ Agent + å·¥å…· |
| `load_tools()` | v0.1 | æ˜¾å¼å¯¼å…¥å·¥å…· |

#### è¿ç§»ç¤ºä¾‹

**AgentExecutor â†’ create_agent**:
```python
# âŒ æ—§ä»£ç 
from langchain.agents import AgentExecutor, create_react_agent

agent_executor = AgentExecutor(
    agent=create_react_agent(llm, tools, prompt),
    tools=tools,
    verbose=True
)

# âœ… æ–°ä»£ç 
from langchain.agents import create_agent

agent = create_agent(
    model=model,
    tools=tools,
    system_prompt=prompt
)
```

### 2. æ¶ˆæ¯å¯¹è±¡å˜æ›´ ğŸ’¬

**`.text()` æ–¹æ³• â†’ `.text` å±æ€§**:
```python
from langchain_core.messages import AIMessage

message = AIMessage(content="ä½ å¥½")

# âŒ æ—§æ–¹å¼ï¼ˆä»å¯ç”¨ä½†æœ‰è­¦å‘Šï¼‰
text = message.text()

# âœ… æ–°æ–¹å¼
text = message.text
```

### 3. AIMessage å˜æ›´ ğŸ¤–

**`example` å‚æ•°è¢«ç§»é™¤**:
```python
# âŒ æ—§ä»£ç 
message = AIMessage(
    content="ä½ å¥½",
    example=True  # âŒ å·²ç§»é™¤
)

# âœ… æ–°ä»£ç 
message = AIMessage(
    content="ä½ å¥½",
    additional_kwargs={"example": True}  # âœ… ä½¿ç”¨ additional_kwargs
)
```

### 4. Agent å®šä¹‰æ–¹å¼ ğŸ—ï¸

**è§„åˆ™**: ä» v1.0 èµ·ï¼Œåªèƒ½åœ¨ LangChain å†…å®šä¹‰ Agent

```python
# âŒ ä¸æ¨èï¼šç›´æ¥ä½¿ç”¨ LangGraph
from langgraph.prebuilt import create_react_agent
agent = create_react_agent(model, tools)

# âœ… æ¨èï¼šä½¿ç”¨ LangChain
from langchain.agents import create_agent
agent = create_agent(model, tools)
```

### 5. æµå¼å¤„ç†å˜æ›´ ğŸŒŠ

**èŠ‚ç‚¹åç§°æ›´æ”¹**:
```python
# âŒ v0.x
async for chunk in agent.astream(...):
    if chunk.get("node") == "agent":  # æ—§åç§°
        print(chunk)

# âœ… v1.0
async for chunk in agent.astream(...):
    if chunk.get("node") == "model":  # æ–°åç§°
        print(chunk)
```

---

## æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“

### 1. ç®€åŒ–å¼€å‘ âš¡

**é‡åŒ–æŒ‡æ ‡**:
- ğŸ“‰ ä»£ç é‡å‡å°‘ 60-80%
- â±ï¸ ä¸Šæ‰‹æ—¶é—´ä»å¤©é™è‡³å°æ—¶
- ğŸ¯ API æ•°é‡å‡å°‘ 70%

**å…·ä½“ä½“ç°**:

**æ—§æ–¹å¼ (~50 è¡Œ)**:
```python
from langchain.agents import AgentType, initialize_agent
from langchain.memory import ConversationBufferMemory
from langchain.prompts import MessagesPlaceholder

memory = ConversationBufferMemory(return_messages=True)
agent = initialize_agent(
    tools=tools,
    llm=llm,
    agent=AgentType.CHAT_CONVERSATIONAL_REACT_DESCRIPTION,
    memory=memory,
    verbose=True,
    agent_kwargs={
        "system_message": "...",
        "extra_prompt_messages": [MessagesPlaceholder(variable_name="memory")],
    }
)
```

**æ–°æ–¹å¼ (~10 è¡Œ)**:
```python
from langchain.agents import create_agent

agent = create_agent(
    model=model,
    tools=tools,
    system_prompt="ä½ æ˜¯æœ‰å¸®åŠ©çš„åŠ©æ‰‹"
)
```

### 2. ç”Ÿäº§å°±ç»ª ğŸ­

**å…³é”®ç‰¹æ€§**:

| ç‰¹æ€§ | è¯´æ˜ | ç”Ÿäº§ä»·å€¼ |
|-----|------|---------|
| **æŒä¹…åŒ–æ‰§è¡Œ** | è‡ªåŠ¨çŠ¶æ€ä¿å­˜ | æœåŠ¡é‡å¯ä¸ä¸¢å¤±è¿›åº¦ |
| **é”™è¯¯æ¢å¤** | æ£€æŸ¥ç‚¹æœºåˆ¶ | ä»å¤±è´¥ç‚¹ç»§ç»­æ‰§è¡Œ |
| **å¹¶å‘æ§åˆ¶** | å†…ç½®é™æµ | é¿å… API é…é¢è¶…é™ |
| **ç›‘æ§é›†æˆ** | LangSmith | å®æ—¶æ€§èƒ½ç›‘æ§ |
| **ç‰ˆæœ¬ç®¡ç†** | è¯­ä¹‰åŒ–ç‰ˆæœ¬ | å®‰å…¨çš„ä¾èµ–å‡çº§ |

**ä¼ä¸šé‡‡ç”¨æ¡ˆä¾‹**:
- **Uber**: å®¢æœè‡ªåŠ¨åŒ– Agent
- **LinkedIn**: å†…å®¹æ¨è Agent
- **Klarna**: è´­ç‰©åŠ©æ‰‹ Agent

### 3. çµæ´»æ€§ ğŸ”§

**å¤šå±‚æ¬¡æŠ½è±¡**:

```
é«˜æŠ½è±¡å±‚ â”€â”€â”
          â”‚  create_agent (å¿«é€Ÿå¼€å‘)
          â”‚  â†“
          â”‚  Middleware (è‡ªå®šä¹‰è¡Œä¸º)
          â”‚  â†“
          â”‚  LangGraph (å®Œå…¨æ§åˆ¶)
          â”‚  â†“
ä½æŠ½è±¡å±‚ â”€â”€â”˜  è‡ªå®šä¹‰å›¾åŸè¯­
```

**é€‚åº”ä¸åŒåœºæ™¯**:
1. **åŸå‹éªŒè¯** (1-2 å¤©): ä½¿ç”¨ `create_agent`
2. **MVP å¼€å‘** (1-2 å‘¨): æ·»åŠ  Middleware
3. **ç”Ÿäº§ä¼˜åŒ–** (1-2 æœˆ): è¿ç§»åˆ° LangGraph
4. **å®šåˆ¶éœ€æ±‚** (æŒç»­): è‡ªå®šä¹‰å›¾ç»“æ„

### 4. ç°ä»£åŒ– ğŸš€

**æœ€æ–° LLM ç‰¹æ€§æ”¯æŒ**:

| ç‰¹æ€§ | æ”¯æŒæ¨¡å‹ | LangChain æŠ½è±¡ |
|-----|---------|---------------|
| **æ¨ç†å—** | Claude, GPT-4o | `content_blocks` |
| **å¼•ç”¨** | Gemini, Claude | `content_blocks` |
| **è§†è§‰è¾“å…¥** | GPT-4V, Claude | `content=[image, text]` |
| **ç»“æ„åŒ–è¾“å‡º** | All | `with_structured_output()` |
| **å‡½æ•°è°ƒç”¨** | All | `bind_tools()` |

### 5. å¯è§‚æµ‹æ€§ ğŸ‘ï¸

**å¤šç»´åº¦ç›‘æ§**:

**1. æ€§èƒ½ç»´åº¦**
```python
# LangSmith è‡ªåŠ¨æ”¶é›†
{
    "latency_ms": 1234,
    "token_usage": {"input": 500, "output": 200},
    "cost_usd": 0.05,
    "cache_hit_rate": 0.75
}
```

---

## è®¾è®¡å“²å­¦æ¼”å˜

### æ—¶é—´çº¿ ğŸ“…

```
2022.10 â”€â”€â”€â”€â”¬â”€â”€â”€â”€ LangChain è¯ç”Ÿ
            â”‚     - Chains æ¦‚å¿µ
            â”‚     - é¢„å®šä¹‰æµç¨‹
            â”‚
2023.06 â”€â”€â”€â”€â”¼â”€â”€â”€â”€ å¿«é€Ÿå¢é•¿
            â”‚     - å¤§é‡ Chain ç±»å‹
            â”‚     - ç¤¾åŒºè´¡çŒ®
            â”‚
2024.02 â”€â”€â”€â”€â”¼â”€â”€â”€â”€ LangGraph å‘å¸ƒ
            â”‚     - ä½å±‚ç¼–æ’æ§åˆ¶
            â”‚     - å›¾åŸè¯­
            â”‚
2024.10 â”€â”€â”€â”€â”¼â”€â”€â”€â”€ LangGraph æˆä¸ºä¸»æµ
            â”‚     - ç”Ÿäº§æ¡ˆä¾‹å¢å¤š
            â”‚     - çµæ´»æ€§éœ€æ±‚
            â”‚
2025.10 â”€â”€â”€â”€â”´â”€â”€â”€â”€ v1.0 å‘å¸ƒ
                  - ç»Ÿä¸€æ¶æ„
                  - ç”Ÿäº§å°±ç»ª
```

### æ¶æ„æ¼”å˜ ğŸ—ï¸

#### ç¬¬ä¸€ä»£: Chains (2022-2023)

**è®¾è®¡æ€è·¯**: é¢„å®šä¹‰çš„å¤„ç†é“¾

**å±€é™æ€§**:
- âŒ çµæ´»æ€§å·®
- âŒ éš¾ä»¥å®šåˆ¶
- âŒ æ— æ³•å¤„ç†å¤æ‚æµç¨‹

#### ç¬¬äºŒä»£: LangGraph (2024)

**è®¾è®¡æ€è·¯**: å›¾çŠ¶æ€æœº

**ä¼˜åŠ¿**:
- âœ… å®Œå…¨çµæ´»
- âœ… å¯è§†åŒ–æµç¨‹
- âœ… å¤æ‚é€»è¾‘æ”¯æŒ

**æŒ‘æˆ˜**:
- âŒ å­¦ä¹ æ›²çº¿é™¡å³­
- âŒ ç®€å•åœºæ™¯è¿‡åº¦å·¥ç¨‹

#### ç¬¬ä¸‰ä»£: ç»Ÿä¸€æ¶æ„ (2025)

**è®¾è®¡æ€è·¯**: åŒå±‚æŠ½è±¡

**æ ¸å¿ƒä»·å€¼**:
- âœ… ç®€å•åœºæ™¯å¿«é€Ÿå¼€å‘ (`create_agent`)
- âœ… å¤æ‚åœºæ™¯å®Œå…¨æ§åˆ¶ (`LangGraph`)
- âœ… æ¸è¿›å¼è¿‡æ¸¡è·¯å¾„
- âœ… ç”Ÿäº§çº§å¯é æ€§

### æ ¸å¿ƒä¿¡å¿µ ğŸ’¡

#### 1. ç»„åˆä¼˜äºé…ç½®

**åæ¨¡å¼** (é…ç½®é©±åŠ¨):
```python
agent = create_agent(
    config={
        "retry": True,
        "retry_max": 3,
        "retry_delay": 1,
        "log": True,
        "log_level": "INFO",
        # ... æ— å°½çš„é…ç½®
    }
)
```

**æ¨èæ¨¡å¼** (ç»„åˆé©±åŠ¨):
```python
agent = create_agent(model, tools, middleware=[
    RetryMiddleware(max_retries=3),
    LoggingMiddleware(level="INFO")
])
```

#### 2. æ˜¾å¼ä¼˜äºéšå¼

**åæ¨¡å¼** (éšå¼è¡Œä¸º):
```python
# é­”æ³•å­—ç¬¦ä¸²è§¦å‘ç‰¹æ®Šè¡Œä¸º
prompt = "Use tool: search"  # âŒ éšå¼
```

**æ¨èæ¨¡å¼** (æ˜¾å¼è°ƒç”¨):
```python
# æ˜ç¡®çš„å·¥å…·ç»‘å®š
model.bind_tools([search_tool])  # âœ… æ˜¾å¼
```

#### 3. æ ‡å‡†ä¼˜äºä¸“æœ‰

**åæ¨¡å¼** (ä¸“æœ‰æ ¼å¼):
```python
# ç»‘å®šç‰¹å®šæä¾›å•†
openai_specific_feature()  # âŒ é”å®š
```

**æ¨èæ¨¡å¼** (æ ‡å‡†æ¥å£):
```python
# é€šç”¨æŠ½è±¡
model.with_structured_output(Schema)  # âœ… å¯ç§»æ¤
```

---

## è¿ç§»æŒ‡å—

### å‰ç½®å‡†å¤‡ ğŸ“‹

#### 1. ç¯å¢ƒæ£€æŸ¥

**æ£€æŸ¥å½“å‰ç‰ˆæœ¬**:
```bash
pip show langchain langchain-core langgraph
```

**ä¾èµ–å®¡è®¡**:
```bash
# åˆ—å‡ºæ‰€æœ‰ langchain ç›¸å…³åŒ…
pip list | grep langchain

# æ£€æŸ¥ä½¿ç”¨çš„å·²å¼ƒç”¨ API
python -W default::DeprecationWarning your_app.py
```

#### 2. å¤‡ä»½

**ä»£ç å¤‡ä»½**:
```bash
git checkout -b pre-v1-backup
git commit -am "Backup before LangChain v1.0 migration"
```

**ä¾èµ–å›ºå®š**:
```bash
pip freeze > requirements-old.txt
```

### è¿ç§»æ­¥éª¤ ğŸ”„

#### æ­¥éª¤ 1: å‡çº§ä¾èµ–

**ä¿å®ˆå‡çº§** (ä¿ç•™å…¼å®¹æ€§):
```bash
# å®‰è£… v1.0 + classic
pip install -U langchain langchain-core langgraph
pip install langchain-classic
```

**æ¿€è¿›å‡çº§** (å®Œå…¨è¿ç§»):
```bash
# ä»…å®‰è£… v1.0
pip install -U langchain langchain-core langgraph
# ä¸å®‰è£… langchain-classic
```

#### æ­¥éª¤ 2: è¿ç§» Agent

**ç¤ºä¾‹: åŸºç¡€ Agent**
```python
# âŒ æ—§ä»£ç 
from langchain.agents import initialize_agent, AgentType

agent = initialize_agent(
    tools=tools,
    llm=llm,
    agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION
)
result = agent.run("æŸ¥è¯¢å¤©æ°”")

# âœ… æ–°ä»£ç 
from langchain.agents import create_agent

agent = create_agent(model=model, tools=tools)
result = agent.invoke({"messages": [{"role": "user", "content": "æŸ¥è¯¢å¤©æ°”"}]})
```

#### æ­¥éª¤ 3: è¿ç§» Chains

**ç®€å• Chain â†’ ç›´æ¥ä½¿ç”¨æ¨¡å‹**:
```python
# âŒ LLMChain
from langchain.chains import LLMChain

chain = LLMChain(llm=llm, prompt=prompt)

# âœ… LCEL (LangChain Expression Language)
chain = prompt | model
```

#### æ­¥éª¤ 4: æµ‹è¯•

**å•å…ƒæµ‹è¯•æ¨¡æ¿**:
```python
import pytest
from langchain.agents import create_agent

@pytest.fixture
def agent():
    return create_agent(model=model, tools=tools)

def test_basic_query(agent):
    result = agent.invoke({
        "messages": [{"role": "user", "content": "æµ‹è¯•æŸ¥è¯¢"}]
    })
    assert "messages" in result
    assert len(result["messages"]) > 0
```

### å¸¸è§é—®é¢˜å¤„ç† ğŸ”§

#### é—®é¢˜ 1: å¯¼å…¥é”™è¯¯

**é”™è¯¯ä¿¡æ¯**:
```
ImportError: cannot import name 'AgentExecutor' from 'langchain.agents'
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# é€‰é¡¹ 1: å®‰è£… classic
pip install langchain-classic

# é€‰é¡¹ 2: è¿ç§»åˆ°æ–° API
# è§ä¸Šæ–‡è¿ç§»ç¤ºä¾‹
```

#### é—®é¢˜ 2: å·¥å…·æ ¼å¼ä¸å…¼å®¹

**é”™è¯¯ä¿¡æ¯**:
```
TypeError: Tool must have 'name' and 'func' attributes
```

**è§£å†³æ–¹æ¡ˆ**:
```python
# âŒ æ—§æ ¼å¼
from langchain.agents import Tool

tool = Tool(
    name="search",
    func=search_function,
    description="æœç´¢å·¥å…·"
)

# âœ… æ–°æ ¼å¼
from langchain_core.tools import tool

@tool
def search(query: str) -> str:
    """æœç´¢å·¥å…·"""
    return search_function(query)
```

### è¿ç§»æ£€æŸ¥æ¸…å• âœ…

**ä»£ç å±‚é¢**:
- [ ] æ‰€æœ‰å¯¼å…¥è·¯å¾„å·²æ›´æ–°
- [ ] `AgentExecutor` å·²æ›¿æ¢ä¸º `create_agent`
- [ ] `LLMChain` å·²è¿ç§»æˆ–ç§»é™¤
- [ ] æ¶ˆæ¯å¯¹è±¡ä½¿ç”¨ `.text` å±æ€§è€Œé `.text()`
- [ ] è¿è¡Œæ—¶é…ç½®ä½¿ç”¨ `context` è€Œé `config["configurable"]`
- [ ] å·¥å…·å®šä¹‰ä½¿ç”¨æ–°æ ¼å¼
- [ ] æµå¼å¤„ç†é€‚é…æ–°èŠ‚ç‚¹åç§°

**æµ‹è¯•å±‚é¢**:
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•å¯¹æ¯”ï¼ˆç¡®ä¿æ— é€€åŒ–ï¼‰
- [ ] è¾¹ç•Œæ¡ˆä¾‹æµ‹è¯•

**æ–‡æ¡£å±‚é¢**:
- [ ] README æ›´æ–°
- [ ] API æ–‡æ¡£æ›´æ–°
- [ ] è¿ç§»è¯´æ˜ç¼–å†™
- [ ] ä¾èµ–ç‰ˆæœ¬å›ºå®š

**è¿ç»´å±‚é¢**:
- [ ] ä¾èµ–æ›´æ–°åˆ°ç”Ÿäº§ç¯å¢ƒ
- [ ] ç›‘æ§æŒ‡æ ‡æ›´æ–°ï¼ˆé€‚é… LangSmithï¼‰
- [ ] å›æ»šæ–¹æ¡ˆå‡†å¤‡
- [ ] å›¢é˜ŸåŸ¹è®­å®Œæˆ

---

## æœ€ä½³å®è·µ

### 1. Agent è®¾è®¡æ¨¡å¼ ğŸ¨

#### æ¨¡å¼ 1: å•ä¸€èŒè´£ Agent

**åŸåˆ™**: æ¯ä¸ª Agent ä¸“æ³¨ä¸€ä¸ªé¢†åŸŸ

```python
# âœ… å¥½çš„è®¾è®¡
customer_service_agent = create_agent(
    model=model,
    tools=[search_kb, create_ticket, escalate],
    system_prompt="ä½ æ˜¯å®¢æœä¸“å‘˜ï¼Œä¸“æ³¨äºè§£å†³å®¢æˆ·é—®é¢˜"
)

sales_agent = create_agent(
    model=model,
    tools=[search_products, calculate_price, create_order],
    system_prompt="ä½ æ˜¯é”€å”®ä¸“å‘˜ï¼Œä¸“æ³¨äºäº§å“æ¨èå’Œè®¢å•"
)

# âŒ ä¸å¥½çš„è®¾è®¡
everything_agent = create_agent(
    model=model,
    tools=[...100 ä¸ªå·¥å…·],  # è¿‡å¤šèŒè´£
    system_prompt="ä½ ä»€ä¹ˆéƒ½èƒ½åš"
)
```

#### æ¨¡å¼ 2: åˆ†å±‚ Agent æ¶æ„

**åœºæ™¯**: å¤æ‚ä¸šåŠ¡æµç¨‹

```python
# é¡¶å±‚ï¼šè·¯ç”± Agent
router_agent = create_agent(
    model=model,
    tools=[
        delegate_to_customer_service,
        delegate_to_sales,
        delegate_to_technical
    ],
    system_prompt="æ ¹æ®ç”¨æˆ·éœ€æ±‚è·¯ç”±åˆ°ä¸“é—¨çš„ Agent"
)

# åº•å±‚ï¼šä¸“ä¸š Agent
def delegate_to_customer_service(query: str) -> str:
    """å§”æ‰˜ç»™å®¢æœ Agent"""
    result = customer_service_agent.invoke({
        "messages": [{"role": "user", "content": query}]
    })
    return result["messages"][-1]["content"]
```

#### æ¨¡å¼ 3: å·¥å…·ä¼˜å…ˆè®¾è®¡

**åŸåˆ™**: å¤æ‚é€»è¾‘å°è£…ä¸ºå·¥å…·

```python
# âœ… å¥½çš„è®¾è®¡ï¼šé€»è¾‘åœ¨å·¥å…·ä¸­
@tool
def complex_calculation(params: dict) -> float:
    """å¤æ‚çš„ä¸šåŠ¡è®¡ç®—é€»è¾‘"""
    # 100 è¡Œè®¡ç®—é€»è¾‘
    return result

agent = create_agent(
    model=model,
    tools=[complex_calculation],
    system_prompt="ä½¿ç”¨å·¥å…·è¿›è¡Œè®¡ç®—"
)

# âŒ ä¸å¥½çš„è®¾è®¡ï¼šä¾èµ– LLM è®¡ç®—
agent = create_agent(
    model=model,
    tools=[],
    system_prompt="è¯·è®¡ç®—ä»¥ä¸‹å¤æ‚å…¬å¼: ..."  # LLM å®¹æ˜“å‡ºé”™
)
```

### 2. å·¥å…·å¼€å‘æœ€ä½³å®è·µ ğŸ”¨

#### è§„èŒƒçš„å·¥å…·å®šä¹‰

```python
from langchain_core.tools import tool
from pydantic import BaseModel, Field

class SearchInput(BaseModel):
    """æœç´¢è¾“å…¥å‚æ•°"""
    query: str = Field(description="æœç´¢æŸ¥è¯¢è¯")
    limit: int = Field(default=10, description="è¿”å›ç»“æœæ•°é‡")
    filters: dict = Field(default={}, description="è¿‡æ»¤æ¡ä»¶")

@tool(args_schema=SearchInput)
def search_database(query: str, limit: int = 10, filters: dict = {}) -> list:
    """
    åœ¨æ•°æ®åº“ä¸­æœç´¢å†…å®¹

    ä½¿ç”¨åœºæ™¯ï¼š
    - æŸ¥æ‰¾ç”¨æˆ·ä¿¡æ¯
    - æœç´¢å†å²è®°å½•
    - æ£€ç´¢äº§å“æ•°æ®

    Args:
        query: æœç´¢å…³é”®è¯ï¼Œæ”¯æŒæ¨¡ç³ŠåŒ¹é…
        limit: æœ€å¤šè¿”å›å¤šå°‘æ¡ç»“æœï¼Œé»˜è®¤ 10
        filters: é¢å¤–çš„è¿‡æ»¤æ¡ä»¶ï¼Œå¦‚ {"status": "active"}

    Returns:
        åŒ¹é…çš„è®°å½•åˆ—è¡¨

    Examples:
        >>> search_database("å¼ ä¸‰", limit=5)
        [{"name": "å¼ ä¸‰", "id": 1}, ...]
    """
    # å®ç°æœç´¢é€»è¾‘
    results = db.query(query, limit=limit, **filters)
    return results
```

#### å·¥å…·é”™è¯¯å¤„ç†

```python
from langchain_core.tools import ToolException

@tool
def risky_operation(param: str) -> str:
    """å¯èƒ½å¤±è´¥çš„æ“ä½œ"""
    try:
        result = external_api_call(param)
        return result
    except ExternalAPIError as e:
        # è½¬æ¢ä¸º ToolExceptionï¼ŒAgent å¯ä»¥ç†è§£
        raise ToolException(
            f"API è°ƒç”¨å¤±è´¥: {e}. è¯·ç¨åé‡è¯•æˆ–è”ç³»ç®¡ç†å‘˜ã€‚"
        )
    except ValueError as e:
        # å‚æ•°é”™è¯¯
        raise ToolException(f"å‚æ•°æ— æ•ˆ: {e}")
```

### 3. æç¤ºè¯å·¥ç¨‹ ğŸ“

#### ç»“æ„åŒ–ç³»ç»Ÿæç¤º

```python
SYSTEM_PROMPT = """
# è§’è‰²å®šä¹‰
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°æ®åˆ†æåŠ©æ‰‹ã€‚

# æ ¸å¿ƒèƒ½åŠ›
- æ•°æ®æŸ¥è¯¢å’Œåˆ†æ
- ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨
- æä¾›ä¸šåŠ¡æ´å¯Ÿ

# å·¥ä½œæµç¨‹
1. ç†è§£ç”¨æˆ·éœ€æ±‚
2. é€‰æ‹©åˆé€‚çš„å·¥å…·
3. åˆ†ææ•°æ®ç»“æœ
4. ç”Ÿæˆæ¸…æ™°çš„æŠ¥å‘Š

# è¾“å‡ºæ ¼å¼
- ä½¿ç”¨ Markdown æ ¼å¼
- æ•°æ®ç”¨è¡¨æ ¼å±•ç¤º
- ç»“è®ºè¦ç®€æ˜æ‰¼è¦

# é™åˆ¶
- ä¸è¦ç¼–é€ æ•°æ®
- ä¸ç¡®å®šæ—¶æ˜ç¡®è¯´æ˜
- è¶…å‡ºèƒ½åŠ›èŒƒå›´æ—¶å»ºè®®äººå·¥ä»‹å…¥
"""

agent = create_agent(
    model=model,
    tools=tools,
    system_prompt=SYSTEM_PROMPT
)
```

### 4. æ€§èƒ½ä¼˜åŒ– âš¡

#### å¹¶è¡Œå·¥å…·è°ƒç”¨

```python
# LangChain ä¼šè‡ªåŠ¨å¹¶è¡Œæ‰§è¡Œç‹¬ç«‹çš„å·¥å…·è°ƒç”¨
# ç¡®ä¿å·¥å…·æ˜¯çº¿ç¨‹å®‰å…¨çš„

import asyncio
from langchain_core.tools import tool

@tool
async def async_search(query: str) -> str:
    """å¼‚æ­¥æœç´¢å·¥å…·"""
    async with aiohttp.ClientSession() as session:
        async with session.get(f"https://api.example.com/search?q={query}") as resp:
            return await resp.text()

# Agent ä¼šè‡ªåŠ¨å¹¶è¡Œè°ƒç”¨å¤šä¸ª async_search
```

#### ç¼“å­˜ç­–ç•¥

```python
from langchain.cache import InMemoryCache, SQLiteCache
from langchain.globals import set_llm_cache

# å¼€å‘ç¯å¢ƒï¼šå†…å­˜ç¼“å­˜
set_llm_cache(InMemoryCache())

# ç”Ÿäº§ç¯å¢ƒï¼šæŒä¹…åŒ–ç¼“å­˜
set_llm_cache(SQLiteCache(database_path=".langchain.db"))

# è‡ªåŠ¨ç¼“å­˜ç›¸åŒçš„ LLM è°ƒç”¨
agent.invoke({"messages": [...]})  # é¦–æ¬¡è°ƒç”¨ API
agent.invoke({"messages": [...]})  # ä»ç¼“å­˜è¯»å–
```

### 5. ç›‘æ§å’Œè°ƒè¯• ğŸ”

#### ç»“æ„åŒ–æ—¥å¿—

```python
import structlog

logger = structlog.get_logger()

class LoggingMiddleware(Middleware):
    def before_model(self, state, config):
        logger.info(
            "model_call_start",
            message_count=len(state.get("messages", [])),
            user_id=config.get("context", {}).get("user_id")
        )
        return state

    def after_model(self, state, response, config):
        logger.info(
            "model_call_end",
            response_length=len(response.content),
            tool_calls=len(response.tool_calls or [])
        )
        return response
```

### 6. å®‰å…¨æœ€ä½³å®è·µ ğŸ”’

#### è¾“å…¥éªŒè¯

```python
from pydantic import validator

class SecureInput(BaseModel):
    user_query: str

    @validator("user_query")
    def validate_query(cls, v):
        # æ£€æŸ¥æ³¨å…¥æ”»å‡»
        forbidden = ["DROP", "DELETE", "UPDATE", "INSERT"]
        if any(word in v.upper() for word in forbidden):
            raise ValueError("æ£€æµ‹åˆ°æ½œåœ¨çš„ SQL æ³¨å…¥")

        # é•¿åº¦é™åˆ¶
        if len(v) > 1000:
            raise ValueError("æŸ¥è¯¢è¿‡é•¿")

        return v
```

#### å·¥å…·æƒé™æ§åˆ¶

```python
from functools import wraps

def require_permission(permission: str):
    def decorator(func):
        @wraps(func)
        def wrapper(*args, config=None, **kwargs):
            user_permissions = config.get("context", {}).get("permissions", [])
            if permission not in user_permissions:
                raise PermissionError(f"éœ€è¦æƒé™: {permission}")
            return func(*args, **kwargs)
        return wrapper
    return decorator

@tool
@require_permission("database.write")
def delete_record(record_id: str) -> str:
    """åˆ é™¤è®°å½•ï¼ˆéœ€è¦å†™æƒé™ï¼‰"""
    db.delete(record_id)
    return "å·²åˆ é™¤"
```

---

## å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£ ğŸ“š

| èµ„æº | é“¾æ¥ | è¯´æ˜ |
|-----|------|------|
| **LangChain æ–‡æ¡£** | https://docs.langchain.com/ | å®Œæ•´çš„å®˜æ–¹æ–‡æ¡£ |
| **v1.0 å‘å¸ƒè¯´æ˜** | https://docs.langchain.com/oss/python/releases/langchain-v1 | æ–°ç‰¹æ€§ä»‹ç» |
| **è¿ç§»æŒ‡å—** | https://docs.langchain.com/oss/python/migrate/langchain-v1 | è¯¦ç»†çš„è¿ç§»æ­¥éª¤ |
| **è®¾è®¡å“²å­¦** | https://docs.langchain.com/oss/python/langchain/philosophy | æ¶æ„ç†å¿µ |
| **API å‚è€ƒ** | https://api.python.langchain.com/ | å®Œæ•´çš„ API æ–‡æ¡£ |

### åšå®¢æ–‡ç«  ğŸ“

| æ ‡é¢˜ | é“¾æ¥ |
|-----|------|
| LangChain & LangGraph 1.0 å‘å¸ƒ | https://blog.langchain.com/langchain-langgraph-1dot0/ |
| LangChain v1.0 Alpha | https://blog.langchain.com/langchain-langchain-1-0-alpha-releases/ |

### ç¤¾åŒºèµ„æº ğŸ‘¥

| èµ„æº | é“¾æ¥ |
|-----|------|
| **GitHub ä»“åº“** | https://github.com/langchain-ai/langchain |
| **Discord ç¤¾åŒº** | https://discord.gg/langchain |
| **Twitter** | https://twitter.com/LangChainAI |
| **YouTube** | https://www.youtube.com/@LangChain |

### å­¦ä¹ è·¯å¾„ ğŸ“

#### åˆå­¦è€…
1. å¿«é€Ÿå¼€å§‹ - 15 åˆ†é’Ÿ
2. æ„å»ºç¬¬ä¸€ä¸ª Agent - 30 åˆ†é’Ÿ
3. å·¥å…·ä½¿ç”¨æ•™ç¨‹ - 1 å°æ—¶

#### è¿›é˜¶
1. ä¸­é—´ä»¶æ·±å…¥ - 2 å°æ—¶
2. LangGraph åŸºç¡€ - 3 å°æ—¶
3. ç”Ÿäº§éƒ¨ç½²æŒ‡å— - 4 å°æ—¶

#### ä¸“å®¶
1. è‡ªå®šä¹‰å›¾æ¶æ„ - 1 å¤©
2. æ€§èƒ½ä¼˜åŒ– - 2 å¤©
3. ä¼ä¸šæœ€ä½³å®è·µ - 1 å‘¨

---

## æ€»ç»“ ğŸ¯

LangChain v1.0 æ ‡å¿—ç€è¯¥æ¡†æ¶ä»**å®éªŒæ€§å·¥å…·**åˆ°**ç”Ÿäº§çº§å¹³å°**çš„é‡è¦è½¬å˜ï¼š

### å…³é”®æˆå°± âœ¨

1. **æ¶æ„ç»Ÿä¸€**: å•ä¸€ Agent æŠ½è±¡ + LangGraph åŒå±‚è®¾è®¡
2. **å¼€å‘ç®€åŒ–**: 10 è¡Œä»£ç æ„å»º Agentï¼Œå­¦ä¹ æ›²çº¿å¤§å¹…é™ä½
3. **ç”Ÿäº§å°±ç»ª**: æŒä¹…åŒ–ã€ç›‘æ§ã€é”™è¯¯å¤„ç†ç­‰ä¼ä¸šçº§ç‰¹æ€§
4. **æ ‡å‡†åŒ–**: è·¨æä¾›å•†çš„ç»Ÿä¸€æ¥å£ï¼Œé¿å…é”å®š
5. **çµæ´»æ€§**: ä»é«˜å±‚æŠ½è±¡åˆ°åº•å±‚æ§åˆ¶çš„æ¸è¿›å¼è·¯å¾„

### é€‚ç”¨åœºæ™¯ ğŸ“Š

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | å¼€å‘å‘¨æœŸ |
|-----|---------|---------|
| å¿«é€ŸåŸå‹ | `create_agent` | 1-3 å¤© |
| MVP äº§å“ | `create_agent` + ä¸­é—´ä»¶ | 1-2 å‘¨ |
| ç”Ÿäº§åº”ç”¨ | LangGraph | 1-3 æœˆ |
| å¤æ‚ç³»ç»Ÿ | è‡ªå®šä¹‰å›¾ + å¤š Agent | 3+ æœˆ |

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨ ğŸš€

**å¦‚æœä½ æ˜¯æ–°ç”¨æˆ·**:
1. âœ… å®‰è£… LangChain v1.0
2. âœ… å®Œæˆå¿«é€Ÿå¼€å§‹æ•™ç¨‹
3. âœ… æ„å»ºç¬¬ä¸€ä¸ª Agent
4. âœ… å°è¯•æ·»åŠ è‡ªå®šä¹‰å·¥å…·

**å¦‚æœä½ è¦è¿ç§»**:
1. âœ… é˜…è¯»è¿ç§»æŒ‡å—
2. âœ… åœ¨æµ‹è¯•ç¯å¢ƒå‡çº§
3. âœ… é€æ­¥è¿ç§»ä»£ç 
4. âœ… å®Œæ•´æµ‹è¯•åéƒ¨ç½²

**æŒç»­å­¦ä¹ **:
- ğŸ“š è®¢é˜… LangChain åšå®¢
- ğŸ’¬ åŠ å…¥ Discord ç¤¾åŒº
- ğŸ¥ å…³æ³¨ YouTube é¢‘é“
- ğŸ”” GitHub Star å¹¶ Watch ä»“åº“

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2025-11-08  
**ç»´æŠ¤è€…**: LangChain ä¸­æ–‡ç¤¾åŒº  
**è®¸å¯**: MIT License

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issue æˆ– PRï¼
