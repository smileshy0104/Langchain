# PyTorch å®Œæ•´é¡¹ç›® - é¡¹ç›®è¯´æ˜

## ğŸ“ é¡¹ç›®å·²åˆ›å»ºå®Œæˆ

é¡¹ç›®ä½ç½®ï¼š`/Users/yuyansong/AiProject/Langchain/pytorch-docs/pytorch_project/`

## ğŸ“‹ é¡¹ç›®æ–‡ä»¶æ¸…å•

```
pytorch_project/
â”œâ”€â”€ ğŸ“„ config.yaml              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ requirements.txt         # Python ä¾èµ–
â”œâ”€â”€ ğŸ“„ README.md                # é¡¹ç›®è¯´æ˜ï¼ˆè‹±æ–‡ï¼‰
â”œâ”€â”€ ğŸ“„ PROJECT_OVERVIEW.md      # é¡¹ç›®æ€»è§ˆï¼ˆè¯¦ç»†ï¼‰
â”œâ”€â”€ ğŸ“„ é¡¹ç›®è¯´æ˜.md              # æœ¬æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ .gitignore               # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ ğŸ”§ run.sh                   # å¿«é€Ÿè¿è¡Œè„šæœ¬
â”œâ”€â”€ ğŸ main.py                  # ä¸»ç¨‹åºå…¥å£
â”‚
â”œâ”€â”€ ğŸ“ src/                     # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ __init__.py            # åŒ…åˆå§‹åŒ–
â”‚   â”œâ”€â”€ data.py                # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ model.py               # æ¨¡å‹å®šä¹‰æ¨¡å—
â”‚   â”œâ”€â”€ train.py               # è®­ç»ƒé€»è¾‘æ¨¡å—
â”‚   â”œâ”€â”€ evaluate.py            # è¯„ä¼°é€»è¾‘æ¨¡å—
â”‚   â””â”€â”€ utils.py               # å·¥å…·å‡½æ•°æ¨¡å—
â”‚
â”œâ”€â”€ ğŸ“ data/                    # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/                   # åŸå§‹æ•°æ®
â”‚   â””â”€â”€ processed/             # å¤„ç†åçš„æ•°æ®
â”‚
â”œâ”€â”€ ğŸ“ models/                  # æ¨¡å‹ä¿å­˜ç›®å½•
â”‚   â””â”€â”€ checkpoints/           # è®­ç»ƒæ£€æŸ¥ç‚¹
â”‚
â””â”€â”€ ğŸ“ notebooks/               # Jupyter notebooks
    â””â”€â”€ exploration.ipynb      # æ•°æ®æ¢ç´¢ï¼ˆå¾…åˆ›å»ºï¼‰
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³• 1: ä½¿ç”¨è¿è¡Œè„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd /Users/yuyansong/AiProject/Langchain/pytorch-docs/pytorch_project
./run.sh
```

### æ–¹æ³• 2: æ‰‹åŠ¨è¿è¡Œ

```bash
cd /Users/yuyansong/AiProject/Langchain/pytorch-docs/pytorch_project

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# è¿è¡Œä¸»ç¨‹åº
python main.py
```

## ğŸ“Š è¿è¡Œåçš„è¾“å‡º

ç¨‹åºè¿è¡Œåä¼šåœ¨ `models/` ç›®å½•ä¸‹ç”Ÿæˆï¼š

1. **final_model.pth** - è®­ç»ƒå¥½çš„æ¨¡å‹å‚æ•°
2. **loss_curves.png** - è®­ç»ƒå’ŒéªŒè¯æŸå¤±æ›²çº¿å›¾
3. **predictions.png** - æ¨¡å‹é¢„æµ‹ç»“æœå¯è§†åŒ–å›¾

## ğŸ¯ é¡¹ç›®ç‰¹ç‚¹

### 1. å®Œæ•´çš„æœºå™¨å­¦ä¹ æµç¨‹

```
æ•°æ®å‡†å¤‡ â†’ æ¨¡å‹æ„å»º â†’ è®­ç»ƒ â†’ è¯„ä¼° â†’ ä¿å­˜ â†’ å¯è§†åŒ–
```

### 2. æ¨¡å—åŒ–è®¾è®¡

æ¯ä¸ªåŠŸèƒ½éƒ½å°è£…åœ¨ç‹¬ç«‹çš„æ¨¡å—ä¸­ï¼š
- `data.py` - è´Ÿè´£æ•°æ®ç”Ÿæˆå’ŒåŠ è½½
- `model.py` - è´Ÿè´£æ¨¡å‹å®šä¹‰
- `train.py` - è´Ÿè´£è®­ç»ƒé€»è¾‘
- `evaluate.py` - è´Ÿè´£æ¨¡å‹è¯„ä¼°
- `utils.py` - æä¾›è¾…åŠ©åŠŸèƒ½

### 3. é…ç½®é©±åŠ¨

æ‰€æœ‰è¶…å‚æ•°éƒ½åœ¨ `config.yaml` ä¸­ç®¡ç†ï¼š

```yaml
training:
  epochs: 100          # ä¿®æ”¹è¿™é‡Œæ”¹å˜è®­ç»ƒè½®æ•°
  learning_rate: 0.01  # ä¿®æ”¹è¿™é‡Œæ”¹å˜å­¦ä¹ ç‡
```

### 4. è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Š

æ¯ä¸ªå‡½æ•°éƒ½æœ‰å®Œæ•´çš„æ–‡æ¡£å­—ç¬¦ä¸²å’Œè¡Œå†…æ³¨é‡Šï¼Œæ–¹ä¾¿å­¦ä¹ å’Œç†è§£ã€‚

## ğŸ“ ä»£ç ç¤ºä¾‹

### æ•°æ®å‡†å¤‡

```python
from src.data import create_linear_data, prepare_dataloaders

# ç”Ÿæˆæ•°æ®
X, y = create_linear_data(num_samples=1000)

# åˆ›å»ºæ•°æ®åŠ è½½å™¨
train_loader, val_loader, test_loader = prepare_dataloaders(X, y)
```

### æ¨¡å‹è®­ç»ƒ

```python
from src.model import create_model
from src.train import train

# åˆ›å»ºæ¨¡å‹
model = create_model(config, device)

# è®­ç»ƒæ¨¡å‹
history = train(model, train_loader, val_loader, config, device)
```

### æ¨¡å‹è¯„ä¼°

```python
from src.evaluate import evaluate_model

# è¯„ä¼°æ¨¡å‹
metrics = evaluate_model(model, test_loader, device)
print(f"MAE: {metrics['MAE']:.4f}")
print(f"MSE: {metrics['MSE']:.4f}")
print(f"RMSE: {metrics['RMSE']:.4f}")
```

## ğŸ”§ è‡ªå®šä¹‰ä¿®æ”¹

### ä¿®æ”¹è®­ç»ƒå‚æ•°

ç¼–è¾‘ `config.yaml`ï¼š

```yaml
training:
  epochs: 200              # å¢åŠ è®­ç»ƒè½®æ•°
  learning_rate: 0.001     # å‡å°å­¦ä¹ ç‡
  
data:
  batch_size: 64           # å¢å¤§æ‰¹æ¬¡å¤§å°
```

### ä½¿ç”¨è‡ªå·±çš„æ•°æ®

ä¿®æ”¹ `src/data.py`ï¼š

```python
def load_my_data(file_path):
    """åŠ è½½è‡ªå®šä¹‰æ•°æ®"""
    import pandas as pd
    df = pd.read_csv(file_path)
    X = torch.tensor(df['features'].values, dtype=torch.float)
    y = torch.tensor(df['target'].values, dtype=torch.float)
    return X, y
```

### æ·»åŠ æ–°çš„æ¨¡å‹

åœ¨ `src/model.py` ä¸­æ·»åŠ ï¼š

```python
class MyCustomModel(nn.Module):
    def __init__(self, input_dim, hidden_dim, output_dim):
        super().__init__()
        self.fc1 = nn.Linear(input_dim, hidden_dim)
        self.relu = nn.ReLU()
        self.fc2 = nn.Linear(hidden_dim, output_dim)
    
    def forward(self, x):
        x = self.fc1(x)
        x = self.relu(x)
        x = self.fc2(x)
        return x
```

## ğŸ“š å­¦ä¹ è·¯å¾„

### åˆå­¦è€…

1. é˜…è¯» `README.md` äº†è§£é¡¹ç›®ç»“æ„
2. è¿è¡Œ `python main.py` æŸ¥çœ‹å®Œæ•´æµç¨‹
3. é˜…è¯» `src/data.py` ç†è§£æ•°æ®å¤„ç†
4. é˜…è¯» `src/model.py` ç†è§£æ¨¡å‹å®šä¹‰
5. é˜…è¯» `src/train.py` ç†è§£è®­ç»ƒå¾ªç¯

### è¿›é˜¶è€…

1. ä¿®æ”¹ `config.yaml` è¿›è¡Œå®éªŒ
2. åœ¨ `src/model.py` ä¸­å®ç°æ–°æ¨¡å‹
3. åœ¨ `src/utils.py` ä¸­æ·»åŠ æ–°åŠŸèƒ½
4. ä½¿ç”¨è‡ªå·±çš„æ•°æ®é›†
5. æ·»åŠ  TensorBoard å¯è§†åŒ–

### é«˜çº§ç”¨æˆ·

1. å®ç°æ—©åœæœºåˆ¶
2. æ·»åŠ å­¦ä¹ ç‡è°ƒåº¦å™¨
3. å®ç°æ¨¡å‹é›†æˆ
4. æ·»åŠ åˆ†å¸ƒå¼è®­ç»ƒ
5. éƒ¨ç½²æ¨¡å‹ä¸º API

## ğŸ› å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•ä½¿ç”¨ GPUï¼Ÿ

**A:** åœ¨ `config.yaml` ä¸­è®¾ç½® `device: "cuda"`ï¼Œç¨‹åºä¼šè‡ªåŠ¨æ£€æµ‹ã€‚

### Q2: è®­ç»ƒå¤ªæ…¢æ€ä¹ˆåŠï¼Ÿ

**A:** 
- å‡å°‘ `epochs` æ•°é‡
- å¢å¤§ `batch_size`
- å¢åŠ  `num_workers`

### Q3: å¦‚ä½•ä¿å­˜è®­ç»ƒæ£€æŸ¥ç‚¹ï¼Ÿ

**A:** ä½¿ç”¨ `utils.py` ä¸­çš„å‡½æ•°ï¼š

```python
from src.utils import save_checkpoint

save_checkpoint(model, optimizer, epoch, loss, 'models/checkpoints/ckpt.pth')
```

### Q4: å¦‚ä½•å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ï¼Ÿ

**A:** è®­ç»ƒå®Œæˆåä¼šè‡ªåŠ¨ç”Ÿæˆ `loss_curves.png`ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨è°ƒç”¨ï¼š

```python
from src.utils import plot_loss_curves

plot_loss_curves(history, save_path='my_plot.png')
```

## ğŸ“– æ‰©å±•é˜…è¯»

- **README.md** - é¡¹ç›®ä½¿ç”¨è¯´æ˜
- **PROJECT_OVERVIEW.md** - è¯¦ç»†çš„é¡¹ç›®æ¶æ„å’Œè®¾è®¡
- **config.yaml** - é…ç½®æ–‡ä»¶è¯´æ˜

## ğŸ’¡ æç¤º

1. é¦–æ¬¡è¿è¡Œå»ºè®®ä½¿ç”¨è¾ƒå°çš„ `epochs` å€¼ï¼ˆå¦‚ 10ï¼‰æµ‹è¯•
2. ä¿®æ”¹é…ç½®åè®°å¾—ä¿å­˜ `config.yaml`
3. å¯ä»¥ä½¿ç”¨ `git` ç®¡ç†ä¸åŒçš„å®éªŒé…ç½®
4. å»ºè®®åˆ›å»º Jupyter notebook è¿›è¡Œæ•°æ®æ¢ç´¢

## ğŸ“ å­¦ä¹ ç›®æ ‡

é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œä½ å°†å­¦ä¼šï¼š

âœ… PyTorch é¡¹ç›®çš„æ ‡å‡†ç»“æ„  
âœ… æ•°æ®åŠ è½½å’Œé¢„å¤„ç†  
âœ… æ¨¡å‹å®šä¹‰å’Œè®­ç»ƒ  
âœ… æ¨¡å‹è¯„ä¼°å’Œå¯è§†åŒ–  
âœ… é…ç½®æ–‡ä»¶çš„ä½¿ç”¨  
âœ… æ¨¡å—åŒ–ç¼–ç¨‹  
âœ… æœ€ä½³å®è·µå’Œä»£ç è§„èŒƒ  

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ä»£ç ä¸­çš„è¯¦ç»†æ³¨é‡Š
2. é˜…è¯» `README.md` å’Œ `PROJECT_OVERVIEW.md`
3. æ£€æŸ¥ `config.yaml` é…ç½®æ˜¯å¦æ­£ç¡®
4. æŸ¥çœ‹ç»ˆç«¯è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯

---

**ç¥å­¦ä¹ æ„‰å¿«ï¼** ğŸ‰
