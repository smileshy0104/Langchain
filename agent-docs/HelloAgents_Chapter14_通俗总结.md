# Hello Agents 第十四章：实战 - 自动化深度研究智能体（通俗总结）

> **本章核心思想**：如果说第十三章的"旅行助手"是帮你**做事**（执行任务），那么本章的"深度研究助手"就是帮你**思考**（获取知识）。我们将复现 DeepResearch，让 AI 像一个专业的研究员一样，帮你调研、阅读、总结，最后写出一份深度报告。

---

## 📖 目录

- [1. 什么是"深度研究"？](#1-什么是深度研究)
- [2. 核心范式：TODO 驱动的研究](#2-核心范式todo-驱动的研究)
- [3. 三个诸葛亮：Agent 分工](#3-三个诸葛亮agent-分工)
- [4. 工具升级：多源搜索与笔记](#4-工具升级多源搜索与笔记)
- [5. 前端体验：流式输出](#5-前端体验流式输出)
- [6. 本章总结](#6-本章总结)

---

## 1. 什么是"深度研究"？

传统的搜索是：你搜一个词，得到一堆链接，然后自己一个个点进去看，自己总结。
**深度研究 (Deep Research)** 是：你给 AI 一个课题（比如"Datawhale 是什么样的组织？"），AI 自动帮你：
1.  **拆解问题**：把大问题拆成几个小问题。
2.  **并行搜索**：去网上找资料，阅读网页。
3.  **去伪存真**：剔除广告和无关信息，提取干货。
4.  **撰写报告**：把碎片信息整合成一篇有理有据的文章。

---

## 2. 核心范式：TODO 驱动的研究

我们采用 **TODO 驱动** 的工作流，把"研究"变成"做任务"。

### 🔄 流程图
```mermaid
用户输入主题
   ↓
1. 规划 (Plan)：拆解成 3-5 个 TODO 任务
   ↓
2. 执行 (Execute)：逐个完成 TODO
   ├─ 搜索资料
   ├─ 阅读总结
   └─ 记录笔记
   ↓
3. 报告 (Report)：整合所有笔记，写成文章
```

---

## 3. 三个诸葛亮：Agent 分工

我们设计了三个专门的 Agent，各司其职：

1.  **📋 研究规划专家 (TODO Planner)**
    *   **任务**：只负责拆解问题。
    *   **输入**："Datawhale 是什��样的组织？"
    *   **输出**：
        *   任务1：Datawhale 的基本信息（成立时间、定位）。
        *   任务2：核心开源项目（Hello-Agents 等）。
        *   任务3：社区文化与影响力。

2.  **🔍 任务总结专家 (Task Summarizer)**
    *   **任务**：负责干脏活累活（搜资料、读网页）。
    *   **输入**：任务1 - Datawhale 基本信息。
    *   **动作**：调用搜索工具，阅读前 5 个网页。
    *   **输出**：一段 200 字的总结，带上引用来源 [1][2]。

3.  **✍️ 报告撰写专家 (Report Writer)**
    *   **任务**：负责最后统稿。
    *   **输入**：所有子任务的总结笔记。
    *   **输出**：一篇结构清晰、有标题、有正文、有参考文献的完整报告。

### 🛠️ ToolAwareSimpleAgent
为了让前端能看到进度，我们改造了基础 Agent，让它变成 `ToolAware`（工具感知）的。每当它调用工具（搜索、记笔记）时，都会发一个信号给前端："正在搜索 xx..."，让用户更有掌控感。

---

## 4. 工具升级：多源搜索与笔记

### 🌐 SearchTool 2.0
之前的搜索工具比较简单，这次我们做了大升级：
*   **多源支持**：Tavily, DuckDuckGo, Perplexity, SearXNG。
*   **去重**：自动去掉重复的 URL。
*   **���断**：自动把太长的网页内容截断，防止 Token 爆炸。

### 📝 NoteTool
Agent 查到的资料不能丢，要记在小本本上。
我们用 `NoteTool` 把每个子任务的总结存成 Markdown 文件，方便最后汇总，也方便用户查看中间过程。

---

## 5. 前端体验：流式输出

深度研究通常需要几分钟，用户不能干等。
我们使用了 **SSE (Server-Sent Events)** 技术，实现流式输出。

### 📺 用户看到的画面
1.  **规划阶段**：看到 AI 正在把问题拆成 3 个任务。
2.  **执行阶段**：
    *   "正在搜索：Datawhale 核心项目..."
    *   "正在阅读：GitHub 仓库..."
    *   "任务 2 已完成 ✅"
3.  **报告阶段**：屏幕上实时打字，一行行生成最终报告。

---

## 6. 本章总结

### 🌟 核心收获

1.  **复杂任务拆解**：学会了如何用"规划-执行-总结"的范式解决开放性大问题。
2.  **知识密集型应用**：不同于旅行助手的"功能型"，这是典型的"知识型" Agent。
3.  **流式体验**：掌握了 SSE 技术，让长耗时任务的用户体验不再枯燥。

### 🚀 下一步是什么？

旅行助手处理的是个人需求，深度研究助手处理的是知识获取。
下一章，我们将挑战更复杂的——**社会模拟**。我们要构建一个**赛博小镇**，让几十个 Agent 在里面生活、工作、社交，看看会涌现出什么样的社会现象！

下一章（第十五章），我们将构建 **赛博小镇 (AI Town)**，复现斯坦福的经典论文，打造一个多智能体虚拟社区！

---

### 🔗 快速传送门
- **GitHub 源码**: [hello-agents/chapter14](https://github.com/jjyaoao/helloagents)
- **安装命令**: `uv sync` 或 `pip install -e .`
