# Hello-Agents ç¬¬ä¸ƒç« ä¹ é¢˜è§£ç­”

> æœ¬æ–‡æ¡£æä¾›ç¬¬ä¸ƒç« ã€Šæ„å»ºä½ çš„ Agent æ¡†æ¶ã€‹çš„ä¹ é¢˜è§£ç­”

---

## ğŸ“š ä¹ é¢˜æ¦‚è§ˆ

æœ¬ç« å…±æœ‰ 5 é“ä¹ é¢˜ï¼Œæ¶µç›–ç†è®ºåˆ†æå’Œå®è·µç¼–ç¨‹ï¼š

1. **ä¹ é¢˜1**: æ¡†æ¶è®¾è®¡ç†å¿µ - æ€è€ƒ"ä¸‡ç‰©çš†å·¥å…·"çš„ä¼˜ç¼ºç‚¹ (ç†è®ºåˆ†æ)
2. **ä¹ é¢˜2**: å¤šæ¨¡å‹æ”¯æŒ - å®è·µæ·»åŠ æ–°çš„æ¨¡å‹ä¾›åº”å•† (ä»£ç å®ç°)
3. **ä¹ é¢˜3**: Agent å®ç°å¯¹æ¯” - å¯¹æ¯”ä¸åŒ Agent çš„é€‚ç”¨åœºæ™¯ (ç†è®ºåˆ†æ)
4. **ä¹ é¢˜4**: å·¥å…·å¼€å‘ - å®ç°ä¸€ä¸ªå®ç”¨çš„è‡ªå®šä¹‰å·¥å…· (ä»£ç å®ç°)
5. **ä¹ é¢˜5**: ç³»ç»Ÿæ‰©å±• - è®¾è®¡æ’ä»¶ç³»ç»Ÿæ¶æ„ (ä»£ç å®ç°)

---

## ä¹ é¢˜1: æ¡†æ¶è®¾è®¡ç†å¿µåˆ†æ

### é¢˜ç›®

æ€è€ƒ"ä¸‡ç‰©çš†å·¥å…·"çš„ä¼˜ç¼ºç‚¹

HelloAgents æ¡†æ¶é‡‡ç”¨"ä¸‡ç‰©çš†å·¥å…·"çš„è®¾è®¡ç†å¿µï¼Œå°† Memoryã€RAG ç­‰éƒ½æŠ½è±¡ä¸ºå·¥å…·ã€‚è¯·åˆ†æï¼š
- è¿™ç§è®¾è®¡ç†å¿µæœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ
- è¿™ç§è®¾è®¡ç†å¿µæœ‰å“ªäº›ç¼ºç‚¹ï¼Ÿ
- åœ¨å®é™…é¡¹ç›®ä¸­åº”è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿ

---

### è§£ç­”1.1: "ä¸‡ç‰©çš†å·¥å…·"çš„ä¼˜ç‚¹

#### âœ… ä¼˜ç‚¹1: ç»Ÿä¸€çš„æŠ½è±¡æ¥å£

**æ ¸å¿ƒç†å¿µ**: æ‰€æœ‰åŠŸèƒ½éƒ½éµå¾ªç›¸åŒçš„æ¥å£ï¼Œå¤§å¹…é™ä½å­¦ä¹ æˆæœ¬

```
ä¼ ç»Ÿæ¡†æ¶çš„å­¦ä¹ æ›²çº¿:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éœ€è¦å­¦ä¹ çš„æ¦‚å¿µ:                      â”‚
â”‚  ğŸ“š Agent æ¥å£                       â”‚
â”‚  ğŸ“š Tool æ¥å£                        â”‚
â”‚  ğŸ“š Memory æ¥å£                      â”‚
â”‚  ğŸ“š Retriever æ¥å£                   â”‚
â”‚  ğŸ“š Callback æ¥å£                    â”‚
â”‚  ğŸ“š Chain æ¥å£                       â”‚
â”‚  ... è¿˜æœ‰æ›´å¤š                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
âŒ å­¦ä¹ æˆæœ¬é«˜ï¼Œæ–°æ‰‹å®¹æ˜“è¿·å¤±

ä¸‡ç‰©çš†å·¥å…·çš„ç®€åŒ–:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éœ€è¦å­¦ä¹ çš„æ¦‚å¿µ:                      â”‚
â”‚  ğŸ“š Agent æ¥å£                       â”‚
â”‚  ğŸ“š Tool æ¥å£ (ç»Ÿä¸€æ‰€æœ‰åŠŸèƒ½)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
âœ… å­¦ä¹ æˆæœ¬ä½ï¼Œä¸€æ¬¡å­¦ä¹ åˆ°å¤„ä½¿ç”¨
```

**ä»£ç ç¤ºä¾‹**:

```python
# æ‰€æœ‰å·¥å…·éƒ½æœ‰ç›¸åŒçš„æ¥å£
from abc import ABC, abstractmethod

class BaseTool(ABC):
    @abstractmethod
    def run(self, input: str) -> str:
        """ç»Ÿä¸€çš„æ‰§è¡Œæ¥å£"""
        pass

# è®¡ç®—å™¨å·¥å…·
class CalculatorTool(BaseTool):
    def run(self, expression: str) -> str:
        return str(eval(expression))

# è®°å¿†å·¥å…· (ä¹Ÿæ˜¯å·¥å…·!)
class MemoryTool(BaseTool):
    def run(self, action: str) -> str:
        if "save" in action:
            return self._save_memory(action)
        return self._get_memory(action)

# RAGå·¥å…· (ä¹Ÿæ˜¯å·¥å…·!)
class RAGTool(BaseTool):
    def run(self, query: str) -> str:
        docs = self._retrieve_docs(query)
        return self._generate_with_context(query, docs)

# ä½¿ç”¨æ—¶å®Œå…¨ä¸€è‡´
calculator_result = calculator_tool.run("2 + 3")
memory_result = memory_tool.run("save:user_name:Alice")
rag_result = rag_tool.run("ä»€ä¹ˆæ˜¯ Python?")
```

**å®é™…ä»·å€¼**:
- âœ… æ–°æ‰‹åªéœ€å­¦ä¹ ä¸€ä¸ªæ¥å£ï¼Œå°±èƒ½ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½
- âœ… ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œæ˜“äºç»´æŠ¤
- âœ… æ‰©å±•æ–°åŠŸèƒ½æ—¶ä¸éœ€è¦å¼•å…¥æ–°çš„æŠ½è±¡æ¦‚å¿µ

---

#### âœ… ä¼˜ç‚¹2: çµæ´»çš„ç»„åˆèƒ½åŠ›

**æ ¸å¿ƒç†å¿µ**: å¯ä»¥è‡ªç”±ç»„åˆä¸åŒå·¥å…·ï¼ŒæŒ‰éœ€æ„å»ºç³»ç»Ÿ

```
å°±åƒæ­ç§¯æœ¨ä¸€æ ·çµæ´»:

åœºæ™¯1: ç®€å•èŠå¤©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
å·¥å…·: []

åœºæ™¯2: å¸¦è®¡ç®—èƒ½åŠ›
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”§ è®¡ç®—å™¨â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åœºæ™¯3: å…¨åŠŸèƒ½åŠ©æ‰‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”§ è®¡ç®—å™¨â”‚
â”‚ ğŸ’¾ è®°å¿†  â”‚
â”‚ ğŸ” æœç´¢  â”‚
â”‚ ğŸ“š RAG   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç ç¤ºä¾‹**:

```python
# åœºæ™¯1: ç®€å•å¯¹è¯ (ä¸éœ€è¦å·¥å…·)
agent1 = SimpleAgent(llm=llm, tools=[])
response = agent1.run("ä½ å¥½")

# åœºæ™¯2: å¸¦è®¡ç®—èƒ½åŠ›
agent2 = SimpleAgent(llm=llm, tools=[calculator])
response = agent2.run("è®¡ç®— 123 * 456")

# åœºæ™¯3: å¸¦è®°å¿†å’Œè®¡ç®—
agent3 = SimpleAgent(llm=llm, tools=[calculator, memory])
agent3.run("æˆ‘å« Alice")
agent3.run("è®¡ç®— 2 + 3, å¹¶è®°ä½ç»“æœ")

# åœºæ™¯4: å…¨åŠŸèƒ½ (è®°å¿†+è®¡ç®—+æœç´¢+RAG)
agent4 = SimpleAgent(llm=llm, tools=[
    calculator,
    memory,
    search,
    rag
])
```

**å®é™…ä»·å€¼**:
- âœ… æŒ‰éœ€ç»„è£…ï¼Œä¸æµªè´¹èµ„æº
- âœ… åŒä¸€ä¸ª Agent ç±»ï¼Œå¯ä»¥åº”å¯¹ä¸åŒåœºæ™¯
- âœ… æ˜“äºè¿›è¡Œ A/B æµ‹è¯• (å¼€å…³æŸä¸ªå·¥å…·çœ‹æ•ˆæœ)
- âœ… å¼€å‘æ—¶å¯ä»¥é€æ­¥æ·»åŠ åŠŸèƒ½

---

#### âœ… ä¼˜ç‚¹3: ç®€åŒ–çš„ç³»ç»Ÿæ¶æ„

**æ ¸å¿ƒç†å¿µ**: å‡å°‘æ¦‚å¿µå±‚æ¬¡ï¼Œé™ä½ç³»ç»Ÿå¤æ‚åº¦

```
æ¶æ„å¯¹æ¯”:

ä¼ ç»Ÿåˆ†å±‚æ¶æ„:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Agent (æ ¸å¿ƒ)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LLM        (å¿…éœ€ç»„ä»¶)              â”‚
â”‚  Memory     (ç‰¹æ®Šå¤„ç†,ç‹¬ç«‹æ¥å£)     â”‚
â”‚  Tools      (ç‰¹æ®Šå¤„ç†,ç‹¬ç«‹æ¥å£)     â”‚
â”‚  Retriever  (ç‰¹æ®Šå¤„ç†,ç‹¬ç«‹æ¥å£)     â”‚
â”‚  Callback   (ç‰¹æ®Šå¤„ç†,ç‹¬ç«‹æ¥å£)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
âŒ 5+ ä¸ªä¸åŒçš„æŠ½è±¡æ¦‚å¿µéœ€è¦ç†è§£

ä¸‡ç‰©çš†å·¥å…·æ¶æ„:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Agent (æ ¸å¿ƒ)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LLM        (å¿…éœ€ç»„ä»¶)              â”‚
â”‚  Tools[]    (ç»Ÿä¸€æ¥å£)              â”‚
â”‚    â”œâ”€ Calculator                    â”‚
â”‚    â”œâ”€ Memory                        â”‚
â”‚    â”œâ”€ RAG                           â”‚
â”‚    â””â”€ Search                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
âœ… åªéœ€ç†è§£ 2 ä¸ªæ¦‚å¿µ: Agent å’Œ Tool
```

**ä»£ç ç¤ºä¾‹**:

```python
# ä¼ ç»Ÿæ–¹å¼ - å¤šä¸ªä¸åŒæ¥å£
class TraditionalAgent:
    def __init__(
        self,
        llm: LLM,
        memory: Memory,           # ç‹¬ç«‹æ¥å£
        tools: List[Tool],        # ç‹¬ç«‹æ¥å£
        retriever: Retriever,     # ç‹¬ç«‹æ¥å£
        callbacks: List[Callback] # ç‹¬ç«‹æ¥å£
    ):
        # éœ€è¦åˆ†åˆ«å¤„ç†æ¯ç§ç»„ä»¶
        self.llm = llm
        self.memory = memory
        self.tools = tools
        self.retriever = retriever
        self.callbacks = callbacks

# ä¸‡ç‰©çš†å·¥å…·æ–¹å¼ - ç»Ÿä¸€æ¥å£
class SimpleAgent:
    def __init__(
        self,
        llm: LLM,
        tools: List[Tool]  # ç»Ÿä¸€æ¥å£ï¼ŒåŒ…å«æ‰€æœ‰åŠŸèƒ½
    ):
        self.llm = llm
        self.tools = tools  # Memoryã€RAG éƒ½åœ¨è¿™é‡Œ

    def run(self, input_text: str) -> str:
        # ç»Ÿä¸€å¤„ç†æ‰€æœ‰å·¥å…·
        for tool in self.tools:
            if self._should_use_tool(tool, input_text):
                return tool.run(input_text)
        return self.llm.invoke(input_text)
```

**å®é™…ä»·å€¼**:
- âœ… æ–°æ‰‹å­¦ä¹ æ›²çº¿å¹³ç¼“
- âœ… ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºè°ƒè¯•
- âœ… å‡å°‘ç‰¹æ®Šæƒ…å†µå¤„ç†
- âœ… é™ä½ç»´æŠ¤æˆæœ¬

---

#### âœ… ä¼˜ç‚¹4: å·¥å…·é“¾çš„è‡ªç„¶è¡¨è¾¾

**æ ¸å¿ƒç†å¿µ**: å·¥å…·ä¹‹é—´å¯ä»¥äº’ç›¸è°ƒç”¨ï¼Œå½¢æˆå·¥å…·é“¾

```
å·¥å…·é“¾ç»„åˆç¤ºä¾‹:

ç®€å•å·¥å…·:
Calculator â†’ ç»“æœ

å·¥å…·è°ƒç”¨å·¥å…·:
RAGTool
  â”œâ”€ SearchTool â†’ æ–‡æ¡£
  â””â”€ GeneratorTool â†’ ç­”æ¡ˆ

å¤æ‚å·¥å…·é“¾:
SmartAssistantTool
  â”œâ”€ åˆ¤æ–­ä»»åŠ¡ç±»å‹
  â”œâ”€ ä»»åŠ¡1: Calculator
  â”œâ”€ ä»»åŠ¡2: RAGTool
  â”‚    â”œâ”€ SearchTool
  â”‚    â””â”€ Generator
  â””â”€ ä»»åŠ¡3: MemoryTool
```

**ä»£ç ç¤ºä¾‹**:

```python
# RAG å·¥å…·å†…éƒ¨ä½¿ç”¨æœç´¢å·¥å…·
class RAGTool(BaseTool):
    def __init__(self, search_tool: BaseTool):
        self.search_tool = search_tool  # å·¥å…·è°ƒç”¨å·¥å…·

    def run(self, query: str) -> str:
        # 1. ä½¿ç”¨æœç´¢å·¥å…·æ£€ç´¢æ–‡æ¡£
        docs = self.search_tool.run(query)

        # 2. åŸºäºæ–‡æ¡£ç”Ÿæˆç­”æ¡ˆ
        return self._generate_with_context(query, docs)

# æ™ºèƒ½åŠ©æ‰‹å·¥å…· - ç»„åˆå¤šä¸ªå·¥å…·
class SmartAssistantTool(BaseTool):
    def __init__(self, tools: List[BaseTool]):
        self.tools = {t.name: t for t in tools}

    def run(self, task: str) -> str:
        # æ ¹æ®ä»»åŠ¡ç±»å‹è°ƒåº¦ä¸åŒå·¥å…·
        if "è®¡ç®—" in task:
            return self.tools["calculator"].run(task)
        elif "æœç´¢" in task:
            return self.tools["search"].run(task)
        elif "è®°ä½" in task:
            return self.tools["memory"].run(task)
        else:
            # ç»„åˆå¤šä¸ªå·¥å…·
            search_result = self.tools["search"].run(task)
            return self.tools["rag"].run(search_result)
```

**å®é™…ä»·å€¼**:
- âœ… å·¥å…·å¯ä»¥é€’å½’ç»„åˆ
- âœ… æ„å»ºå±‚æ¬¡åŒ–çš„å·¥å…·ç³»ç»Ÿ
- âœ… å®ç°å¤æ‚çš„å·¥ä½œæµ
- âœ… æé«˜ä»£ç å¤ç”¨æ€§

---

### è§£ç­”1.2: "ä¸‡ç‰©çš†å·¥å…·"çš„ç¼ºç‚¹

#### âŒ ç¼ºç‚¹1: è¯­ä¹‰ä¸æ¸…æ™°

**æ ¸å¿ƒé—®é¢˜**: å°†æ¦‚å¿µä¸Šä¸åŒçš„äº‹ç‰©ç»Ÿä¸€ä¸º"å·¥å…·"ï¼Œå¯èƒ½é€ æˆç†è§£å›°æƒ‘

```
è¯­ä¹‰æ··ä¹±ç¤ºä¾‹:

è¿™äº›çœŸçš„éƒ½æ˜¯"å·¥å…·"å—?
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CalculatorTool â†’ è®¡ç®—å™¨å·¥å…·      â”‚  âœ… åˆç†
â”‚ SearchTool â†’ æœç´¢å·¥å…·            â”‚  âœ… åˆç†
â”‚ MemoryTool â†’ è®°å¿†å·¥å…·?           â”‚  â“ è®°å¿†æ˜¯å·¥å…·å—?
â”‚ RAGTool â†’ RAGå·¥å…·?               â”‚  â“ RAGæ˜¯å·¥å…·å—?
â”‚ CallbackTool â†’ å›è°ƒå·¥å…·?         â”‚  â“ å›è°ƒæ˜¯å·¥å…·å—?
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä»æ¦‚å¿µè¯­ä¹‰ä¸Šçœ‹:
Memory â†’ åº”è¯¥æ˜¯ä¸€ç§"èƒ½åŠ›"æˆ–"çŠ¶æ€"
RAG â†’ åº”è¯¥æ˜¯ä¸€ç§"ç»„ä»¶"
Callback â†’ åº”è¯¥æ˜¯ä¸€ç§"æœºåˆ¶"
```

**ä»£ç ç¤ºä¾‹**:

```python
# å¼ºè¡Œç»Ÿä¸€ä¸ºå·¥å…· - è¯­ä¹‰ä¸æ¸…æ™°
memory_tool = MemoryTool()      # â“ è®°å¿†æ˜¯å·¥å…·å—?
rag_tool = RAGTool()            # â“ RAGæ˜¯å·¥å…·å—?
callback_tool = CallbackTool()  # â“ å›è°ƒæ˜¯å·¥å…·å—?

# è¯­ä¹‰æ›´æ¸…æ™°çš„è®¾è®¡
memory = Memory()           # âœ… è®°å¿†æ˜¯ä¸€ç§èƒ½åŠ›/çŠ¶æ€
retriever = Retriever()     # âœ… æ£€ç´¢å™¨æ˜¯ä¸€ç§ç»„ä»¶
callback = Callback()       # âœ… å›è°ƒæ˜¯ä¸€ç§æœºåˆ¶
```

**å®é™…å½±å“**:
- âŒ åˆå­¦è€…å›°æƒ‘: "è®°å¿†ä¸ºä»€ä¹ˆæ˜¯å·¥å…·?"
- âŒ è¿å"æŒ‰æ¦‚å¿µåˆ†å±‚"çš„è®¾è®¡åŸåˆ™
- âŒ ä»£ç é˜…è¯»æ—¶éœ€è¦é¢å¤–çš„å¿ƒç†è½¬æ¢
- âŒ å›¢é˜Ÿæ²Ÿé€šæˆæœ¬å¢åŠ 

---

#### âŒ ç¼ºç‚¹2: æ€§èƒ½å¼€é”€

**æ ¸å¿ƒé—®é¢˜**: ç»Ÿä¸€æ¥å£å¯èƒ½å¸¦æ¥é¢å¤–çš„æ€§èƒ½å¼€é”€

```
æ€§èƒ½å¼€é”€æ¥æº:

å­—ç¬¦ä¸²åºåˆ—åŒ–/ååºåˆ—åŒ–:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¾“å…¥: "save:key:value"            â”‚
â”‚   â†“ è§£æ (å¼€é”€1)                  â”‚
â”‚ action = "save"                   â”‚
â”‚ key = "key"                       â”‚
â”‚ value = "value"                   â”‚
â”‚   â†“ æ‰§è¡Œ                          â”‚
â”‚ result = {"status": "ok"}         â”‚
â”‚   â†“ åºåˆ—åŒ– (å¼€é”€2)                â”‚
â”‚ è¾“å‡º: '{"status":"ok"}'           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¯¹æ¯”ç›´æ¥è°ƒç”¨:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ memory.save("key", "value")       â”‚
â”‚   â†“ æ— éœ€è§£æ                      â”‚
â”‚ ç›´æ¥æ“ä½œ                          â”‚
â”‚   â†“ æ— éœ€åºåˆ—åŒ–                    â”‚
â”‚ è¿”å›å¯¹è±¡                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç ç¤ºä¾‹**:

```python
# æ–¹å¼1: ä¸‡ç‰©çš†å·¥å…· - æœ‰æ€§èƒ½å¼€é”€
class MemoryTool(BaseTool):
    def run(self, input: str) -> str:
        # å¼€é”€1: è§£æå­—ç¬¦ä¸²è¾“å…¥
        action, key, value = input.split(":")

        if action == "save":
            result = self._save(key, value)
        else:
            result = self._get(key)

        # å¼€é”€2: åºåˆ—åŒ–è¿”å›å€¼
        return json.dumps(result)

# æ–¹å¼2: ç›´æ¥è°ƒç”¨ - æ— é¢å¤–å¼€é”€
class Memory:
    def save(self, key: str, value: Any):
        """ç›´æ¥æ“ä½œï¼Œæ— éœ€åºåˆ—åŒ–"""
        self._storage[key] = value

    def get(self, key: str) -> Any:
        """ç›´æ¥è¿”å›å¯¹è±¡"""
        return self._storage.get(key)
```

**æ€§èƒ½æµ‹è¯•**:

```python
import time

# æµ‹è¯•1: å·¥å…·æ–¹å¼
memory_tool = MemoryTool()
start = time.time()
for i in range(10000):
    memory_tool.run(f"save:key_{i}:value_{i}")
print(f"å·¥å…·æ–¹å¼: {time.time() - start:.3f}s")  # çº¦ 0.5s

# æµ‹è¯•2: ç›´æ¥æ–¹å¼
memory = Memory()
start = time.time()
for i in range(10000):
    memory.save(f"key_{i}", f"value_{i}")
print(f"ç›´æ¥æ–¹å¼: {time.time() - start:.3f}s")  # çº¦ 0.1s

# ç»“è®º: å·¥å…·æ–¹å¼æ…¢ 5 å€
```

**å®é™…å½±å“**:
- âŒ æ¯æ¬¡å·¥å…·è°ƒç”¨éƒ½æœ‰å­—ç¬¦ä¸²è§£æå¼€é”€
- âŒ å¤æ‚æ•°æ®ç»“æ„çš„åºåˆ—åŒ–æˆæœ¬é«˜
- âŒ å¯¹äºé«˜é¢‘æ“ä½œ(å¦‚è®°å¿†è®¿é—®)ï¼Œæ€§èƒ½æŸå¤±æ˜æ˜¾
- âŒ ç”Ÿäº§ç¯å¢ƒå¯èƒ½éœ€è¦é¢å¤–ä¼˜åŒ–

---

#### âŒ ç¼ºç‚¹3: ç±»å‹å®‰å…¨é—®é¢˜

**æ ¸å¿ƒé—®é¢˜**: ç»Ÿä¸€çš„å­—ç¬¦ä¸²æ¥å£å¤±å»äº†ç±»å‹æ£€æŸ¥çš„å¥½å¤„

```
ç±»å‹å®‰å…¨å¯¹æ¯”:

ä¸‡ç‰©çš†å·¥å…· (å­—ç¬¦ä¸²æ¥å£):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ tool.run("SELECT * FROM users") â”‚
â”‚ tool.run("SLECT * FROM users")  â”‚ âŒ æ‹¼å†™é”™è¯¯ï¼ŒIDE ä¸ä¼šæç¤º
â”‚ tool.run("SELECT * FROM usr")   â”‚ âŒ è¡¨åé”™è¯¯ï¼Œè¿è¡Œæ—¶æ‰å‘ç°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç±»å‹åŒ–æ¥å£:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ db.query(                       â”‚
â”‚     table="users",              â”‚ âœ… IDE è‡ªåŠ¨è¡¥å…¨
â”‚     filters={"age": {"$gt": 18}}â”‚ âœ… ç±»å‹æ£€æŸ¥
â”‚ )                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç ç¤ºä¾‹**:

```python
# æ–¹å¼1: ä¸‡ç‰©çš†å·¥å…· - å¤±å»ç±»å‹æ£€æŸ¥
class DatabaseTool(BaseTool):
    def run(self, input: str) -> str:
        # è¾“å…¥æ˜¯å­—ç¬¦ä¸²ï¼ŒIDE æ— æ³•æ£€æŸ¥
        # è¿è¡Œæ—¶æ‰èƒ½å‘ç°é”™è¯¯
        query = input
        return self._execute(query)

# âŒ æ‹¼å†™é”™è¯¯ï¼ŒIDE ä¸ä¼šæç¤º
result = db_tool.run("SELECT * FROM users WHERE age_wrong > 18")

# æ–¹å¼2: ç±»å‹åŒ–æ¥å£ - æœ‰ç±»å‹æ£€æŸ¥
class Database:
    def query(
        self,
        table: str,
        filters: Dict[str, Any]
    ) -> List[Dict]:
        # IDE å¯ä»¥æ£€æŸ¥å‚æ•°ç±»å‹
        pass

# âœ… IDE ä¼šæ£€æŸ¥å‚æ•°ç±»å‹
result = db.query("users", {"age": {"$gt": 18}})

# âœ… ä½¿ç”¨ Pydantic æ›´å¼ºå¤§
from pydantic import BaseModel

class QueryParams(BaseModel):
    table: str
    filters: Dict[str, Any]

    class Config:
        extra = "forbid"  # ä¸å…è®¸é¢å¤–å­—æ®µ

def typed_query(params: QueryParams):
    # è‡ªåŠ¨éªŒè¯å’Œç±»å‹è½¬æ¢
    pass
```

**å®é™…å½±å“**:
- âŒ å¤±å» IDE çš„æ™ºèƒ½æç¤ºå’Œè‡ªåŠ¨è¡¥å…¨
- âŒ å¤±å»é™æ€ç±»å‹æ£€æŸ¥ (å¦‚ mypy)
- âŒ é”™è¯¯åªèƒ½åœ¨è¿è¡Œæ—¶å‘ç°
- âŒ é™ä½å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡
- âŒ é‡æ„æ—¶å®¹æ˜“é—æ¼

---

#### âŒ ç¼ºç‚¹4: è°ƒè¯•å›°éš¾

**æ ¸å¿ƒé—®é¢˜**: ç»Ÿä¸€æ¥å£ä½¿å¾—è°ƒè¯•å’Œé”™è¯¯è¿½è¸ªå˜å¾—å›°éš¾

```
é”™è¯¯æ ˆå¯¹æ¯”:

ä¸‡ç‰©çš†å·¥å…·çš„é”™è¯¯æ ˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Traceback:                          â”‚
â”‚   agent.run("å¸®æˆ‘æŸ¥è¯¢å¤©æ°”")         â”‚
â”‚   tool_executor.execute("weather")  â”‚
â”‚   tool.run("åŒ—äº¬")                  â”‚
â”‚   Error: Tool execution failed      â”‚ âŒ å“ªä¸ªå·¥å…·?
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åˆ†å±‚è®¾è®¡çš„é”™è¯¯æ ˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Traceback:                          â”‚
â”‚   agent.run("å¸®æˆ‘æŸ¥è¯¢å¤©æ°”")         â”‚
â”‚   weather_api.get_weather("åŒ—äº¬")   â”‚
â”‚   requests.get(url)                 â”‚
â”‚   Error: WeatherAPIError: 404       â”‚ âœ… æ¸…æ™°æ˜ç¡®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç ç¤ºä¾‹**:

```python
# æ–¹å¼1: ä¸‡ç‰©çš†å·¥å…· - é”™è¯¯æ¨¡ç³Š
try:
    result = agent.run("å¸®æˆ‘æŸ¥è¯¢å¤©æ°”å¹¶ä¿å­˜åˆ°è®°å¿†")
except Exception as e:
    # âŒ é”™è¯¯ä¿¡æ¯ä¸æ¸…æ™°
    print(e)  # "Tool execution failed"
    # æ˜¯å“ªä¸ªå·¥å…·å¤±è´¥çš„? å¤©æ°”å·¥å…·è¿˜æ˜¯è®°å¿†å·¥å…·?
    # è¾“å…¥å‚æ•°æ˜¯ä»€ä¹ˆ?

# æ–¹å¼2: æ˜ç¡®çš„æ¥å£ - é”™è¯¯æ¸…æ™°
try:
    weather = weather_api.get_weather("åŒ—äº¬")
    memory.save("last_weather", weather)
except WeatherAPIError as e:
    # âœ… æ˜ç¡®çŸ¥é“æ˜¯å¤©æ°” API é”™è¯¯
    print(f"å¤©æ°”æŸ¥è¯¢å¤±è´¥: {e}")
except MemoryError as e:
    # âœ… æ˜ç¡®çŸ¥é“æ˜¯è®°å¿†ä¿å­˜é”™è¯¯
    print(f"è®°å¿†ä¿å­˜å¤±è´¥: {e}")
```

**æ—¥å¿—å¯¹æ¯”**:

```python
# ä¸‡ç‰©çš†å·¥å…·çš„æ—¥å¿—
"""
2024-01-27 10:00:00 INFO: Tool executed
2024-01-27 10:00:01 ERROR: Tool execution failed
"""
# âŒ ä¸çŸ¥é“å“ªä¸ªå·¥å…·ï¼Œå‚æ•°æ˜¯ä»€ä¹ˆ

# åˆ†å±‚è®¾è®¡çš„æ—¥å¿—
"""
2024-01-27 10:00:00 INFO: WeatherAPI.get_weather(city='åŒ—äº¬')
2024-01-27 10:00:01 ERROR: WeatherAPIError: API rate limit exceeded
"""
# âœ… æ¸…æ™°æ˜ç¡®ï¼Œæ˜“äºå®šä½é—®é¢˜
```

**å®é™…å½±å“**:
- âŒ é”™è¯¯ä¿¡æ¯ä¸å¤Ÿç²¾ç¡®
- âŒ è°ƒè¯•æ—¶éœ€è¦æ·±å…¥å·¥å…·å†…éƒ¨
- âŒ æ—¥å¿—åˆ†æå›°éš¾
- âŒ ç”Ÿäº§ç¯å¢ƒé—®é¢˜å®šä½è€—æ—¶
- âŒ å¢åŠ æ•…éšœæ’æŸ¥æˆæœ¬

---

#### âŒ ç¼ºç‚¹5: è¿åå•ä¸€èŒè´£åŸåˆ™

**æ ¸å¿ƒé—®é¢˜**: å°†ä¸åŒèŒè´£çš„ç»„ä»¶ç»Ÿä¸€ä¸ºå·¥å…·ï¼Œè¿åäº†è½¯ä»¶å·¥ç¨‹çš„åŸºæœ¬åŸåˆ™

```
å•ä¸€èŒè´£åŸåˆ™ (SRP):
ä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› 

ä¸‡ç‰©çš†å·¥å…·è¿å SRP:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BaseTool.run(input: str)        â”‚
â”‚                                 â”‚
â”‚ æ‰¿æ‹…çš„èŒè´£:                      â”‚
â”‚ 1ï¸âƒ£ å¤–éƒ¨å·¥å…·è°ƒç”¨                â”‚
â”‚ 2ï¸âƒ£ å†…éƒ¨çŠ¶æ€ç®¡ç†                â”‚
â”‚ 3ï¸âƒ£ æ•°æ®æ£€ç´¢                    â”‚
â”‚ 4ï¸âƒ£ ç³»ç»Ÿå›è°ƒ                    â”‚
â”‚ 5ï¸âƒ£ å·¥ä½œæµç¼–æ’                  â”‚
â”‚                                 â”‚
â”‚ âŒ å¤ªå¤šèŒè´£äº†!                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æŒ‰èŒè´£åˆ†å±‚:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tool: å¤–éƒ¨å·¥å…·è°ƒç”¨              â”‚
â”‚ State: çŠ¶æ€ç®¡ç†                 â”‚
â”‚ Retriever: æ•°æ®æ£€ç´¢             â”‚
â”‚ Callback: ç³»ç»Ÿå›è°ƒ              â”‚
â”‚ Workflow: å·¥ä½œæµç¼–æ’            â”‚
â”‚                                 â”‚
â”‚ âœ… èŒè´£æ¸…æ™°                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç ç¤ºä¾‹**:

```python
# ä¸‡ç‰©çš†å·¥å…· - è¿å SRP
class BaseTool(ABC):
    @abstractmethod
    def run(self, input: str) -> str:
        """
        è¿™ä¸ªæ¥å£è¦å¤„ç†:
        1. å¤–éƒ¨å·¥å…·è°ƒç”¨ (Calculator, Search)
        2. å†…éƒ¨çŠ¶æ€ç®¡ç† (Memory)
        3. æ•°æ®æ£€ç´¢ (RAG)
        4. ç³»ç»Ÿå›è°ƒ (Callback)
        5. å·¥ä½œæµç¼–æ’ (Agent Chain)

        èŒè´£å¤ªå¤šäº†!
        """
        pass

# æŒ‰èŒè´£åˆ†å±‚ - éµå¾ª SRP
class Tool(ABC):
    """å¤–éƒ¨å·¥å…·æ¥å£ - å•ä¸€èŒè´£"""
    def execute(self, input: str) -> str:
        pass

class State(ABC):
    """çŠ¶æ€ç®¡ç†æ¥å£ - å•ä¸€èŒè´£"""
    def get(self, key: str) -> Any:
        pass

    def set(self, key: str, value: Any):
        pass

class Retriever(ABC):
    """æ£€ç´¢æ¥å£ - å•ä¸€èŒè´£"""
    def retrieve(self, query: str) -> List[Document]:
        pass

# Agent ç»„åˆä¸åŒèŒè´£çš„ç»„ä»¶
class Agent:
    def __init__(
        self,
        llm: LLM,
        tools: List[Tool],
        state: Optional[State] = None,
        retriever: Optional[Retriever] = None
    ):
        self.llm = llm
        self.tools = tools
        self.state = state
        self.retriever = retriever
```

**å®é™…å½±å“**:
- âŒ è¿å SOLID åŸåˆ™
- âŒ ä»£ç è€¦åˆåº¦é«˜
- âŒ éš¾ä»¥å•ç‹¬æµ‹è¯•æ¯ä¸ªèŒè´£
- âŒ å˜æ›´æ—¶å½±å“èŒƒå›´å¤§
- âŒ é•¿æœŸç»´æŠ¤æˆæœ¬é«˜

---

### è§£ç­”1.3: ç»¼åˆè¯„ä»·ä¸é€‰æ‹©å»ºè®®

#### ğŸ¯ é€‚ç”¨åœºæ™¯åˆ†æ

```
ä¸‡ç‰©çš†å·¥å…· é€‚åˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… æ•™å­¦åœºæ™¯                     â”‚
â”‚    - å¿«é€Ÿç†è§£ Agent å·¥ä½œåŸç†   â”‚
â”‚    - é™ä½å­¦ä¹ é—¨æ§›              â”‚
â”‚                                â”‚
â”‚ âœ… åŸå‹å¼€å‘                     â”‚
â”‚    - å¿«é€ŸéªŒè¯æƒ³æ³•              â”‚
â”‚    - è¿­ä»£é€Ÿåº¦å¿«                â”‚
â”‚                                â”‚
â”‚ âœ… ç®€å•åº”ç”¨                     â”‚
â”‚    - å·¥å…·æ•°é‡å°‘ (< 5 ä¸ª)       â”‚
â”‚    - äº¤äº’ç®€å•                  â”‚
â”‚                                â”‚
â”‚ âœ… ä¸ªäººé¡¹ç›®                     â”‚
â”‚    - ä»£ç é‡å°                  â”‚
â”‚    - æ˜“äºç»´æŠ¤                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸‡ç‰©çš†å·¥å…· ä¸é€‚åˆ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âŒ ç”Ÿäº§ç³»ç»Ÿ                     â”‚
â”‚    - éœ€è¦é«˜æ€§èƒ½                â”‚
â”‚    - éœ€è¦å¯é æ€§                â”‚
â”‚                                â”‚
â”‚ âŒ å¤§å‹é¡¹ç›®                     â”‚
â”‚    - éœ€è¦ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥        â”‚
â”‚    - éœ€è¦è¯¦ç»†çš„é”™è¯¯è¿½è¸ª        â”‚
â”‚                                â”‚
â”‚ âŒ å›¢é˜Ÿåä½œ                     â”‚
â”‚    - éœ€è¦æ¸…æ™°çš„æ¥å£å®šä¹‰        â”‚
â”‚    - éœ€è¦ç»Ÿä¸€çš„å¼€å‘è§„èŒƒ        â”‚
â”‚                                â”‚
â”‚ âŒ å¤æ‚ä¸šåŠ¡                     â”‚
â”‚    - éœ€è¦ç²¾ç¡®çš„é”™è¯¯å¤„ç†        â”‚
â”‚    - éœ€è¦æ€§èƒ½ä¼˜åŒ–              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### ğŸ’¡ æŠ˜ä¸­æ–¹æ¡ˆ: æ··åˆæ¶æ„

**æ ¸å¿ƒæ€æƒ³**: æ ¸å¿ƒç»„ä»¶ç‹¬ç«‹ï¼Œæ‰©å±•åŠŸèƒ½ç”¨å·¥å…·

```python
class HybridAgent:
    """æŠ˜ä¸­æ–¹æ¡ˆ - æ··åˆæ¶æ„"""

    def __init__(
        self,
        llm: LLM,                      # æ ¸å¿ƒ: ç‹¬ç«‹æ¥å£
        memory: Optional[Memory],       # æ ¸å¿ƒ: ç‹¬ç«‹æ¥å£
        tools: Optional[List[Tool]],    # æ‰©å±•: å·¥å…·æ¥å£
    ):
        """
        è®¾è®¡ç†å¿µ:
        - æ ¸å¿ƒåŠŸèƒ½ (LLM, Memory) ç”¨ç‹¬ç«‹æ¥å£ â†’ é«˜æ€§èƒ½
        - æ‰©å±•åŠŸèƒ½ (Tools) ç”¨å·¥å…·æ¥å£ â†’ çµæ´»æ€§
        """
        self.llm = llm
        self.memory = memory
        self.tools = tools or []

    def run(self, input: str) -> str:
        # æ ¸å¿ƒåŠŸèƒ½ç”¨ç›´æ¥è°ƒç”¨ (é«˜æ€§èƒ½)
        history = self.memory.get_history() if self.memory else []

        # æ‰©å±•åŠŸèƒ½ç”¨å·¥å…·æ¥å£ (çµæ´»æ€§)
        for tool in self.tools:
            if self._should_use_tool(tool, input):
                result = tool.run(input)
                # ä¿å­˜åˆ°è®°å¿† (ç›´æ¥è°ƒç”¨)
                if self.memory:
                    self.memory.save("last_result", result)
                return result

        # LLM è°ƒç”¨ (ç›´æ¥è°ƒç”¨)
        return self.llm.invoke(history + [input])
```

**ä¼˜ç‚¹**:
- âœ… ä¿ç•™æ ¸å¿ƒåŠŸèƒ½çš„æ€§èƒ½å’Œç±»å‹å®‰å…¨
- âœ… ä¿ç•™æ‰©å±•åŠŸèƒ½çš„çµæ´»æ€§
- âœ… å¹³è¡¡äº†ç®€å•æ€§å’Œå¯ç»´æŠ¤æ€§
- âœ… é€‚åˆä¸­å¤§å‹é¡¹ç›®

---

#### ğŸ“Š å¯¹æ¯”è¡¨æ ¼

| ç»´åº¦ | ä¸‡ç‰©çš†å·¥å…· | ä¼ ç»Ÿåˆ†å±‚æ¶æ„ | æŠ˜ä¸­æ–¹æ¡ˆ |
|------|-----------|-------------|---------|
| **å­¦ä¹ æˆæœ¬** | â­â­â­â­â­ å¾ˆä½ | â­â­ è¾ƒé«˜ | â­â­â­â­ ä½ |
| **æ€§èƒ½** | â­â­ è¾ƒå·® | â­â­â­â­â­ å¾ˆå¥½ | â­â­â­â­ å¥½ |
| **ç±»å‹å®‰å…¨** | â­ å·® | â­â­â­â­â­ å¾ˆå¥½ | â­â­â­â­ å¥½ |
| **çµæ´»æ€§** | â­â­â­â­â­ å¾ˆé«˜ | â­â­â­ ä¸­ç­‰ | â­â­â­â­ é«˜ |
| **å¯ç»´æŠ¤æ€§** | â­â­â­ ä¸­ç­‰ | â­â­â­â­ å¥½ | â­â­â­â­ å¥½ |
| **è°ƒè¯•éš¾åº¦** | â­â­ å›°éš¾ | â­â­â­â­â­ å®¹æ˜“ | â­â­â­â­ è¾ƒå®¹æ˜“ |
| **é€‚åˆè§„æ¨¡** | å°å‹ | å¤§å‹ | ä¸­å¤§å‹ |
| **é€‚åˆåœºæ™¯** | æ•™å­¦ã€åŸå‹ | ç”Ÿäº§ã€å›¢é˜Ÿ | é€šç”¨ |

---

#### ğŸ“ å®è·µå»ºè®®

```
å­¦ä¹ é˜¶æ®µ:
â””â”€ ä½¿ç”¨"ä¸‡ç‰©çš†å·¥å…·"
   â””â”€ å¿«é€Ÿç†è§£ Agent å·¥ä½œåŸç†
   â””â”€ é™ä½å­¦ä¹ æ›²çº¿
   â””â”€ ä¸“æ³¨äºæ ¸å¿ƒæ¦‚å¿µ

åŸå‹å¼€å‘:
â””â”€ ç»§ç»­ä½¿ç”¨"ä¸‡ç‰©çš†å·¥å…·"
   â””â”€ å¿«é€Ÿè¿­ä»£éªŒè¯æƒ³æ³•
   â””â”€ çµæ´»ç»„åˆåŠŸèƒ½
   â””â”€ é™ä½å¼€å‘æˆæœ¬

ç”Ÿäº§éƒ¨ç½²:
â””â”€ é€‰æ‹©1: é‡æ„ä¸ºåˆ†å±‚æ¶æ„
   â”œâ”€ æ€§èƒ½è¦æ±‚é«˜
   â”œâ”€ å›¢é˜Ÿè§„æ¨¡å¤§
   â””â”€ é•¿æœŸç»´æŠ¤

â””â”€ é€‰æ‹©2: é‡‡ç”¨æŠ˜ä¸­æ–¹æ¡ˆ
   â”œâ”€ å¹³è¡¡æ€§èƒ½å’Œçµæ´»æ€§
   â”œâ”€ ä¿ç•™å·²æœ‰ä»£ç 
   â””â”€ æ¸è¿›å¼ä¼˜åŒ–
```

---

### ğŸ’­ æ€»ç»“

**"ä¸‡ç‰©çš†å·¥å…·"æ˜¯ä¸€ä¸ªä¼˜ç§€çš„æ•™å­¦ç†å¿µï¼Œä½†ä¸ä¸€å®šæ˜¯æœ€ä½³çš„ç”Ÿäº§å®è·µã€‚**

**å…³é”®æ´å¯Ÿ**:
1. âœ… ç®€å•æ€§å’Œæ€§èƒ½å¾€å¾€æ˜¯çŸ›ç›¾çš„
2. âœ… ç»Ÿä¸€æŠ½è±¡é™ä½å­¦ä¹ æˆæœ¬ï¼Œä½†å¯èƒ½ç‰ºç‰²ä¸“ä¸šæ€§
3. âœ… æ¡†æ¶è®¾è®¡è¦æ ¹æ®ç›®æ ‡åœºæ™¯é€‰æ‹©æƒè¡¡ç­–ç•¥
4. âœ… æ²¡æœ‰é“¶å¼¹ï¼Œåªæœ‰æœ€é€‚åˆçš„æ–¹æ¡ˆ

**å®è·µè·¯å¾„**:
- ğŸ“š **å­¦ä¹ **: ç”¨"ä¸‡ç‰©çš†å·¥å…·"å¿«é€Ÿç†è§£åŸç†
- ğŸ”¨ **åŸå‹**: ç»§ç»­ä½¿ç”¨ï¼Œå¿«é€Ÿè¿­ä»£
- ğŸ­ **ç”Ÿäº§**: è€ƒè™‘é‡æ„æˆ–æŠ˜ä¸­æ–¹æ¡ˆ
- ğŸ¯ **ä¼˜åŒ–**: æ ¹æ®å®é™…éœ€æ±‚ä¸æ–­è°ƒæ•´

---

## ä¹ é¢˜2: å¤šæ¨¡å‹æ”¯æŒ

### é¢˜ç›®

å®è·µæ·»åŠ æ–°çš„æ¨¡å‹ä¾›åº”å•†

ä¸ºæ¡†æ¶æ·»åŠ å¯¹ä¸åŒ LLM æä¾›å•†çš„æ”¯æŒï¼Œå®ç°ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—å¯ä»¥æ–¹ä¾¿åœ°åˆ‡æ¢ä¸åŒçš„æ¨¡å‹ã€‚

è¦æ±‚ï¼š
- å®ç°ç»Ÿä¸€çš„æ¨¡å‹ç®¡ç†å™¨
- æ”¯æŒè‡³å°‘ 3 ä¸ªä¸åŒçš„æ¨¡å‹æä¾›å•†
- å¯ä»¥é€šè¿‡ç®€å•çš„é…ç½®åˆ‡æ¢æ¨¡å‹

---

### è§£ç­”2.1: MultiModelLLM è®¾è®¡

#### ğŸ¯ è®¾è®¡ç›®æ ‡

```
ç»Ÿä¸€æ¥å£è®¾è®¡:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     MultiModelLLM (ç»Ÿä¸€æ¥å£)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  provider: str                      â”‚
â”‚  model: str                         â”‚
â”‚  llm: BaseChatModel                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  + _create_llm()                    â”‚
â”‚  + invoke(messages)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ æ”¯æŒå¤šä¸ªæä¾›å•†
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚         â”‚     â”‚     â”‚    â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â” â”Œâ–¼â”€â”€â”€â” â”Œâ–¼â”€â”€â–¼â”
â”‚æ™ºè°±AIâ”‚ â”‚Claudeâ”‚ â”‚æœˆä¹‹æš—â”‚ â”‚Ollamaâ”‚
â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜
GLM-4   Claude-3  Moonshot llama2
```

#### ğŸ’» æ ¸å¿ƒå®ç°

```python
from typing import Optional
from langchain_core.language_models.chat_models import BaseChatModel
from langchain_community.chat_models import ChatZhipuAI

class MultiModelLLM:
    """
    å¤šæ¨¡å‹ LLM ç®¡ç†å™¨
    æ”¯æŒå¤šä¸ªæ¨¡å‹æä¾›å•†çš„ç»Ÿä¸€æ¥å£
    """

    def __init__(
        self,
        provider: str = "zhipuai",
        model: Optional[str] = None,
        **kwargs
    ):
        """
        åˆå§‹åŒ–å¤šæ¨¡å‹ LLM

        Args:
            provider: æä¾›å•† (zhipuai/anthropic/moonshot/ollama)
            model: æ¨¡å‹åç§°
            **kwargs: å…¶ä»–å‚æ•°
        """
        self.provider = provider.lower()
        self.model = model
        self.kwargs = kwargs
        self.llm = self._create_llm()

    def _create_llm(self) -> BaseChatModel:
        """æ ¹æ®æä¾›å•†åˆ›å»ºå¯¹åº”çš„ LLM å®ä¾‹"""
        if self.provider == "zhipuai":
            return self._create_zhipuai_llm()
        elif self.provider == "anthropic":
            return self._create_anthropic_llm()
        elif self.provider == "moonshot":
            return self._create_moonshot_llm()
        elif self.provider == "ollama":
            return self._create_ollama_llm()
        else:
            raise ValueError(f"ä¸æ”¯æŒçš„æä¾›å•†: {self.provider}")

    def _create_zhipuai_llm(self) -> ChatZhipuAI:
        """åˆ›å»ºæ™ºè°± AI LLM"""
        import os
        api_key = os.getenv("ZHIPUAI_API_KEY")
        model = self.model or "glm-4-plus"
        temperature = self.kwargs.get("temperature", 0.7)

        return ChatZhipuAI(
            model=model,
            temperature=temperature,
            zhipuai_api_key=api_key
        )

    def _create_anthropic_llm(self) -> BaseChatModel:
        """åˆ›å»º Anthropic Claude LLM"""
        from langchain_anthropic import ChatAnthropic
        import os

        api_key = os.getenv("ANTHROPIC_API_KEY")
        model = self.model or "claude-3-5-sonnet-20241022"
        temperature = self.kwargs.get("temperature", 0.7)

        return ChatAnthropic(
            model=model,
            temperature=temperature,
            anthropic_api_key=api_key
        )

    def _create_moonshot_llm(self) -> BaseChatModel:
        """åˆ›å»º Moonshot AI LLM (ä½¿ç”¨ OpenAI å…¼å®¹æ ¼å¼)"""
        from langchain_openai import ChatOpenAI
        import os

        api_key = os.getenv("MOONSHOT_API_KEY")
        model = self.model or "moonshot-v1-8k"

        return ChatOpenAI(
            model=model,
            openai_api_key=api_key,
            openai_api_base="https://api.moonshot.cn/v1"
        )

    def _create_ollama_llm(self) -> BaseChatModel:
        """åˆ›å»ºæœ¬åœ° Ollama LLM"""
        from langchain_community.chat_models import ChatOllama

        model = self.model or "llama2"
        base_url = self.kwargs.get("base_url", "http://localhost:11434")

        return ChatOllama(
            model=model,
            base_url=base_url
        )

    def invoke(self, messages):
        """è°ƒç”¨ LLM"""
        return self.llm.invoke(messages)
```

---

### è§£ç­”2.2: ä½¿ç”¨ç¤ºä¾‹

#### ğŸ“ åŸºæœ¬ä½¿ç”¨

```python
# 1. æ™ºè°± AI
llm1 = MultiModelLLM(provider="zhipuai", model="glm-4-flash")
response1 = llm1.invoke([{"role": "user", "content": "ä½ å¥½"}])
print(response1.content)

# 2. Anthropic Claude
llm2 = MultiModelLLM(provider="anthropic")
response2 = llm2.invoke([{"role": "user", "content": "Hello"}])
print(response2.content)

# 3. Moonshot AI
llm3 = MultiModelLLM(provider="moonshot")
response3 = llm3.invoke([{"role": "user", "content": "ä½ å¥½"}])
print(response3.content)

# 4. æœ¬åœ° Ollama
llm4 = MultiModelLLM(provider="ollama", model="llama2")
response4 = llm4.invoke([{"role": "user", "content": "Hi"}])
print(response4.content)
```

#### ğŸ¤– ä¸ Agent é›†æˆ

```python
from agents.simple_agent_langchain import SimpleAgent

# åˆ›å»ºä¸åŒæ¨¡å‹çš„ Agent
def create_agent(provider: str, model: str = None):
    llm = MultiModelLLM(provider=provider, model=model)
    return SimpleAgent(
        name=f"{provider}åŠ©æ‰‹",
        llm=llm.llm
    )

# ä½¿ç”¨æ™ºè°± AI
agent1 = create_agent("zhipuai", "glm-4-flash")
response1 = agent1.run("ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½?")

# ä½¿ç”¨ Claude (å¦‚æœé…ç½®äº† API Key)
agent2 = create_agent("anthropic")
response2 = agent2.run("What is AI?")

# è½»æ¾åˆ‡æ¢æ¨¡å‹
print(f"æ™ºè°±: {response1}")
print(f"Claude: {response2}")
```

---

### è§£ç­”2.3: é…ç½®ç®¡ç†

#### âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®

```bash
# .env æ–‡ä»¶

# å¿…éœ€: æ™ºè°± AI
ZHIPUAI_API_KEY=your-zhipuai-key

# å¯é€‰: Anthropic Claude
ANTHROPIC_API_KEY=your-anthropic-key

# å¯é€‰: Moonshot AI
MOONSHOT_API_KEY=your-moonshot-key

# å¯é€‰: Ollama (æœ¬åœ°,æ— éœ€ API Key)
# åªéœ€å®‰è£…å¹¶å¯åŠ¨ Ollama æœåŠ¡
```

#### ğŸ“Š æ”¯æŒçš„æ¨¡å‹åˆ—è¡¨

```python
SUPPORTED_MODELS = {
    "zhipuai": [
        "glm-4-plus",      # æœ€å¼ºæ€§èƒ½
        "glm-4-flash",     # å¿«é€Ÿå“åº”
        "glm-4",           # å¹³è¡¡
        "glm-3-turbo"      # ç»æµ
    ],
    "anthropic": [
        "claude-3-5-sonnet-20241022",  # æœ€æ–°
        "claude-3-opus-20240229",      # æœ€å¼º
        "claude-3-sonnet-20240229",    # å¹³è¡¡
        "claude-3-haiku-20240307"      # å¿«é€Ÿ
    ],
    "moonshot": [
        "moonshot-v1-8k",    # 8K ä¸Šä¸‹æ–‡
        "moonshot-v1-32k",   # 32K ä¸Šä¸‹æ–‡
        "moonshot-v1-128k"   # 128K ä¸Šä¸‹æ–‡
    ],
    "ollama": [
        "llama2",      # Meta Llama 2
        "mistral",     # Mistral 7B
        "codellama",   # Code Llama
        "qwen"         # é€šä¹‰åƒé—®
    ]
}
```

---

### è§£ç­”2.4: æ‰©å±•åŠŸèƒ½

#### ğŸ¯ è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡å‹

```python
class SmartModelSelector:
    """æ™ºèƒ½æ¨¡å‹é€‰æ‹©å™¨"""

    def select_model(self, task_type: str, budget: str) -> tuple:
        """
        æ ¹æ®ä»»åŠ¡ç±»å‹å’Œé¢„ç®—é€‰æ‹©æ¨¡å‹

        Args:
            task_type: ä»»åŠ¡ç±»å‹ (chat/code/analysis/creative)
            budget: é¢„ç®— (low/medium/high)

        Returns:
            (provider, model) å…ƒç»„
        """
        if task_type == "chat":
            if budget == "low":
                return ("zhipuai", "glm-4-flash")
            elif budget == "medium":
                return ("zhipuai", "glm-4-plus")
            else:
                return ("anthropic", "claude-3-5-sonnet")

        elif task_type == "code":
            if budget == "low":
                return ("ollama", "codellama")
            else:
                return ("anthropic", "claude-3-5-sonnet")

        elif task_type == "creative":
            return ("anthropic", "claude-3-opus")

        else:
            return ("zhipuai", "glm-4-plus")

# ä½¿ç”¨ç¤ºä¾‹
selector = SmartModelSelector()
provider, model = selector.select_model("chat", "low")
llm = MultiModelLLM(provider=provider, model=model)
```

#### ğŸ”„ æ¨¡å‹çƒ­åˆ‡æ¢

```python
class DynamicAgent:
    """æ”¯æŒåŠ¨æ€åˆ‡æ¢æ¨¡å‹çš„ Agent"""

    def __init__(self):
        self.current_provider = "zhipuai"
        self.current_model = "glm-4-flash"
        self._update_llm()

    def _update_llm(self):
        """æ›´æ–° LLM å®ä¾‹"""
        self.llm = MultiModelLLM(
            provider=self.current_provider,
            model=self.current_model
        )

    def switch_model(self, provider: str, model: str = None):
        """åˆ‡æ¢æ¨¡å‹"""
        self.current_provider = provider
        self.current_model = model
        self._update_llm()
        print(f"âœ… å·²åˆ‡æ¢åˆ°: {provider} - {model or 'default'}")

    def run(self, query: str) -> str:
        """æ‰§è¡ŒæŸ¥è¯¢"""
        response = self.llm.invoke([
            {"role": "user", "content": query}
        ])
        return response.content

# ä½¿ç”¨ç¤ºä¾‹
agent = DynamicAgent()

# ä½¿ç”¨æ™ºè°±
response1 = agent.run("ä½ å¥½")

# åˆ‡æ¢åˆ° Claude
agent.switch_model("anthropic")
response2 = agent.run("Hello")

# åˆ‡æ¢å›æ™ºè°±
agent.switch_model("zhipuai", "glm-4-plus")
response3 = agent.run("å†è§")
```

---

### ğŸ’¡ æ‰©å±•æ€è€ƒ

1. **å¦‚ä½•å®ç°æ¨¡å‹è´Ÿè½½å‡è¡¡?**
   - æç¤º: ç»´æŠ¤å¤šä¸ª LLM å®ä¾‹ï¼Œè½®æµä½¿ç”¨
   - æç¤º: ç›‘æ§æ¯ä¸ªæ¨¡å‹çš„å“åº”æ—¶é—´

2. **å¦‚ä½•å®ç°æ¨¡å‹é™çº§ç­–ç•¥?**
   - æç¤º: å½“é¦–é€‰æ¨¡å‹å¤±è´¥æ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨æ¨¡å‹
   - æç¤º: è®¾ç½®é™çº§é“¾: Claude â†’ GLM-4 â†’ Ollama

3. **å¦‚ä½•ä¼˜åŒ–æ¨¡å‹é€‰æ‹©?**
   - æç¤º: è®°å½•ä¸åŒæ¨¡å‹åœ¨ä¸åŒä»»åŠ¡ä¸Šçš„è¡¨ç°
   - æç¤º: ä½¿ç”¨æœºå™¨å­¦ä¹ é¢„æµ‹æœ€ä¼˜æ¨¡å‹

4. **å¦‚ä½•ç®¡ç† API é…é¢?**
   - æç¤º: è·Ÿè¸ªæ¯ä¸ª API çš„ä½¿ç”¨é‡
   - æç¤º: æ¥è¿‘é…é¢æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–æ¨¡å‹

---

### ğŸ“¦ å®Œæ•´ä»£ç 

å®Œæ•´å®ç°è§: [exercise_02_new_model_provider.py](../agent-langchain-code/HelloAgents_Chapter7_Code/exercises/exercise_02_new_model_provider.py)

è¿è¡Œæµ‹è¯•:
```bash
cd agent-langchain-code/HelloAgents_Chapter7_Code/exercises
python exercise_02_new_model_provider.py
```

---

## ä¹ é¢˜3: Agent å®ç°å¯¹æ¯”

### é¢˜ç›®

å¯¹æ¯”ä¸åŒ Agent çš„é€‚ç”¨åœºæ™¯

æœ¬ç« å®ç°äº†å¤šç§ Agentï¼šSimpleAgentã€ReActAgentã€ReflectionAgentã€PlanAndSolveAgentã€‚è¯·åˆ†æï¼š
- æ¯ç§ Agent çš„æ ¸å¿ƒç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ
- å®ƒä»¬å„è‡ªé€‚ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿ
- å¦‚ä½•æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„ Agentï¼Ÿ

---

### è§£ç­”3.1: å››ç§ Agent æ ¸å¿ƒå¯¹æ¯”

#### ğŸ“Š å¯¹æ¯”æ€»è§ˆ

```
Agent æ¶æ„è°±ç³»:
                         å¤æ‚åº¦ â†’
ç®€å• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ å¤æ‚
â”‚                                           â”‚
SimpleAgent â†’ ReActAgent â†’ ReflectionAgent â†’ PlanAndSolve
â”‚              â”‚             â”‚                â”‚
å•æ¬¡è°ƒç”¨      å¾ªç¯æ¨ç†      è‡ªæˆ‘åæ€         å…ˆè®¡åˆ’åæ‰§è¡Œ
å¿«é€Ÿ          ä¸­é€Ÿ          æ…¢é€Ÿ             æœ€æ…¢
ä½æˆæœ¬        ä¸­æˆæœ¬        é«˜æˆæœ¬           æœ€é«˜æˆæœ¬
```

| Agent ç±»å‹ | æ ¸å¿ƒç‰¹ç‚¹ | æ‰§è¡Œæ¨¡å¼ | Tokenæ¶ˆè€— | é€‚ç”¨åœºæ™¯ |
|-----------|---------|---------|----------|---------|
| **SimpleAgent** | ç›´æ¥å¯¹è¯ | å•æ¬¡è°ƒç”¨ | 100-500 | ç®€å•é—®ç­” |
| **ReActAgent** | æ¨ç†-è¡ŒåŠ¨ | 3-5æ­¥å¾ªç¯ | 500-2K | å·¥å…·è¾…åŠ© |
| **ReflectionAgent** | è‡ªæˆ‘åæ€ | 2-3è½®è¿­ä»£ | 1K-5K | é«˜è´¨é‡è¾“å‡º |
| **PlanAndSolveAgent** | è®¡åˆ’æ‰§è¡Œ | 5-10æ­¥éª¤ | 2K-10K | å¤æ‚ä»»åŠ¡ |

---

### è§£ç­”3.2: SimpleAgent è¯¦è§£

#### ğŸ¯ æ ¸å¿ƒç‰¹ç‚¹

```
SimpleAgent å·¥ä½œæµç¨‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·è¾“å…¥ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç³»ç»Ÿæç¤ºè¯   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è°ƒç”¨ LLM    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿”å›å“åº”    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰¹ç‚¹:
âœ… æœ€ç®€å•
âœ… æœ€å¿«é€Ÿ
âœ… æˆæœ¬æœ€ä½
âŒ æ— æ³•ä½¿ç”¨å·¥å…·
âŒ æ— æ¨ç†èƒ½åŠ›
```

#### ğŸ’» ä»£ç å®ç°

```python
class SimpleAgent(BaseAgent):
    """æœ€åŸºç¡€çš„ Agentï¼Œç›´æ¥è°ƒç”¨ LLM"""

    def run(self, input_text: str) -> str:
        """å•æ¬¡è°ƒç”¨ï¼Œç›´æ¥è¿”å›"""
        messages = [
            {"role": "system", "content": self.system_prompt},
            {"role": "user", "content": input_text}
        ]
        response = self.llm.invoke(messages)
        return response.content
```

#### ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

```python
# æ€§èƒ½æµ‹è¯•
å¹³å‡å“åº”æ—¶é—´: 1-2ç§’
Token æ¶ˆè€—: 100-500 tokens
æˆåŠŸç‡: 95% (ç®€å•ä»»åŠ¡)
æˆæœ¬: $0.001 / æ¬¡
```

#### âœ… é€‚ç”¨åœºæ™¯

```python
# åœºæ™¯1: ç®€å•é—®ç­”
agent.run("ä»€ä¹ˆæ˜¯ Python?")
# âœ… å®Œç¾é€‚ç”¨

# åœºæ™¯2: æ–‡æœ¬ç”Ÿæˆ
agent.run("å†™ä¸€é¦–å…³äºæ˜¥å¤©çš„è¯—")
# âœ… å®Œç¾é€‚ç”¨

# åœºæ™¯3: ç¿»è¯‘
agent.run("æŠŠ'Hello World'ç¿»è¯‘æˆä¸­æ–‡")
# âœ… å®Œç¾é€‚ç”¨
```

#### âŒ ä¸é€‚ç”¨åœºæ™¯

```python
# åœºæ™¯1: éœ€è¦è®¡ç®—
agent.run("è®¡ç®— 123456 * 789012")
# âŒ LLM å¯èƒ½ç®—é”™
# åº”è¯¥ä½¿ç”¨ ReActAgent + Calculator

# åœºæ™¯2: éœ€è¦å®æ—¶ä¿¡æ¯
agent.run("ä»Šå¤©åŒ—äº¬çš„å¤©æ°”å¦‚ä½•?")
# âŒ LLM æ²¡æœ‰æœ€æ–°æ•°æ®
# åº”è¯¥ä½¿ç”¨ ReActAgent + Weather API

# åœºæ™¯3: å¤šæ­¥æ¨ç†
agent.run("å…ˆæœç´¢Pythonä¿¡æ¯,ç„¶åç”Ÿæˆå­¦ä¹ è®¡åˆ’")
# âŒ å¯èƒ½é—æ¼æ­¥éª¤
# åº”è¯¥ä½¿ç”¨ PlanAndSolveAgent
```

---

### è§£ç­”3.3: ReActAgent è¯¦è§£

#### ğŸ¯ æ ¸å¿ƒç‰¹ç‚¹

```
ReActAgent å·¥ä½œæµç¨‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·é—®é¢˜ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Thought: æˆ‘éœ€è¦å…ˆ...    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action: calculator[2+3] â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Observation: 5          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“ (å¾ªç¯)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Thought: ç°åœ¨æˆ‘å¯ä»¥...  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action: Finish[ç­”æ¡ˆ]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰¹ç‚¹:
âœ… å¯ä»¥ä½¿ç”¨å·¥å…·
âœ… æœ‰æ¨ç†èƒ½åŠ›
âœ… è‡ªåŠ¨é€‰æ‹©å·¥å…·
âŒ å¯èƒ½é™·å…¥å¾ªç¯
âŒ Token æ¶ˆè€—è¾ƒå¤š
```

#### ğŸ’» æ ¸å¿ƒå®ç°

```python
class ReActAgent(BaseAgent):
    """
    ReAct = Reasoning + Acting
    é€šè¿‡ Thought-Action-Observation å¾ªç¯è§£å†³é—®é¢˜
    """

    def run(self, input_text: str) -> str:
        messages = [{"role": "user", "content": input_text}]

        for step in range(self.max_iterations):
            # ç”Ÿæˆ Thought å’Œ Action
            response = self.llm.invoke(messages)
            thought, action = self._parse_output(response.content)

            # æ£€æŸ¥æ˜¯å¦å®Œæˆ
            if "Finish" in action:
                return self._extract_final_answer(action)

            # æ‰§è¡Œå·¥å…·
            observation = self._execute_tool(action)

            # æ›´æ–°æ¶ˆæ¯
            messages.append({
                "role": "assistant",
                "content": f"Thought: {thought}\nAction: {action}"
            })
            messages.append({
                "role": "user",
                "content": f"Observation: {observation}"
            })

        return "è¾¾åˆ°æœ€å¤§æ­¥æ•°é™åˆ¶"
```

#### ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

```python
# æ€§èƒ½æµ‹è¯•
å¹³å‡æ­¥æ•°: 3-5æ­¥
å¹³å‡å“åº”æ—¶é—´: 5-10ç§’
Token æ¶ˆè€—: 500-2000 tokens
æˆåŠŸç‡: 80% (å¤æ‚ä»»åŠ¡)
æˆæœ¬: $0.005 / æ¬¡
```

#### âœ… é€‚ç”¨åœºæ™¯

```python
# åœºæ™¯1: æ•°å­¦è®¡ç®—
agent.run("è®¡ç®—å¤åˆ©: æœ¬é‡‘10000,å¹´åˆ©ç‡5%,10å¹´åæ˜¯å¤šå°‘?")
# âœ… ä½¿ç”¨ calculator å·¥å…·

# åœºæ™¯2: ä¿¡æ¯æ£€ç´¢
agent.run("æœç´¢ LangChain çš„æœ€æ–°ç‰ˆæœ¬å¹¶æ€»ç»“æ–°ç‰¹æ€§")
# âœ… ä½¿ç”¨ search å·¥å…·

# åœºæ™¯3: å¤šæ­¥éª¤æ¨ç†
agent.run("""
1. æœç´¢æ¯”ç‰¹å¸å½“å‰ä»·æ ¼
2. è®¡ç®—è´­ä¹° 0.5 ä¸ªéœ€è¦å¤šå°‘é’±
3. æ€»ç»“æŠ•èµ„é£é™©
""")
# âœ… è‡ªåŠ¨é€‰æ‹©å’Œç»„åˆå·¥å…·
```

---

### è§£ç­”3.4: Agent é€‰æ‹©å†³ç­–æ ‘

#### ğŸŒ³ å†³ç­–æµç¨‹

```
                    å¼€å§‹
                     |
              é—®é¢˜æ˜¯å¦ç®€å•?
               /         \
             æ˜¯            å¦
             |             |
       SimpleAgent    æ˜¯å¦éœ€è¦å·¥å…·?
                       /         \
                     æ˜¯            å¦
                     |             |
              æ˜¯å¦æœ‰æ˜ç¡®æ­¥éª¤?   æ˜¯å¦éœ€è¦é«˜è´¨é‡?
               /         \        /         \
             æ˜¯           å¦      æ˜¯          å¦
             |            |      |           |
        PlanAndSolve  ReActAgent Reflection SimpleAgent
```

#### ğŸ“‹ é€‰æ‹©æ£€æŸ¥æ¸…å•

```python
def select_agent(task: dict) -> str:
    """
    æ ¹æ®ä»»åŠ¡ç‰¹ç‚¹é€‰æ‹© Agent

    Args:
        task: {
            "complexity": "simple/medium/complex",
            "need_tools": True/False,
            "need_quality": True/False,
            "has_clear_steps": True/False,
            "time_sensitive": True/False
        }

    Returns:
        æ¨èçš„ Agent ç±»å‹
    """
    # 1. æ—¶æ•ˆæ€§è¦æ±‚é«˜ â†’ SimpleAgent
    if task["time_sensitive"]:
        return "SimpleAgent"

    # 2. ä¸éœ€è¦å·¥å…· â†’ SimpleAgent
    if not task["need_tools"]:
        return "SimpleAgent"

    # 3. éœ€è¦é«˜è´¨é‡ â†’ ReflectionAgent
    if task["need_quality"]:
        return "ReflectionAgent"

    # 4. æœ‰æ˜ç¡®æ­¥éª¤ â†’ PlanAndSolveAgent
    if task["has_clear_steps"]:
        return "PlanAndSolveAgent"

    # 5. å…¶ä»–æƒ…å†µ â†’ ReActAgent
    return "ReActAgent"

# ä½¿ç”¨ç¤ºä¾‹
task1 = {
    "complexity": "simple",
    "need_tools": False,
    "need_quality": False,
    "has_clear_steps": False,
    "time_sensitive": True
}
print(select_agent(task1))  # SimpleAgent

task2 = {
    "complexity": "complex",
    "need_tools": True,
    "need_quality": False,
    "has_clear_steps": True,
    "time_sensitive": False
}
print(select_agent(task2))  # PlanAndSolveAgent
```

---

### ğŸ’¡ å®é™…æ¡ˆä¾‹

#### æ¡ˆä¾‹1: å®¢æœèŠå¤©æœºå™¨äºº

```
éœ€æ±‚: å›ç­”ç”¨æˆ·å¸¸è§é—®é¢˜
ç‰¹ç‚¹:
- å¤§éƒ¨åˆ†æ˜¯ç®€å•é—®ç­”
- éœ€è¦å¿«é€Ÿå“åº”
- æˆæœ¬è¦ä½
- ä¸éœ€è¦å¤æ‚æ¨ç†

é€‰æ‹©: SimpleAgent âœ…
ç†ç”±: å¿«é€Ÿã€ä½æˆæœ¬ã€è¶³å¤Ÿç”¨
```

#### æ¡ˆä¾‹2: æ•°æ®åˆ†æåŠ©æ‰‹

```
éœ€æ±‚: åˆ†æé”€å”®æ•°æ®ï¼Œç”ŸæˆæŠ¥è¡¨
ç‰¹ç‚¹:
- éœ€è¦æŸ¥è¯¢æ•°æ®åº“
- éœ€è¦è®¡ç®—ç»Ÿè®¡æŒ‡æ ‡
- å¤šæ­¥éª¤ä»»åŠ¡
- æ­¥éª¤æ¯”è¾ƒå›ºå®š

é€‰æ‹©: PlanAndSolveAgent âœ…
ç†ç”±: ç»“æ„åŒ–ä»»åŠ¡ï¼Œæ­¥éª¤æ¸…æ™°
```

#### æ¡ˆä¾‹3: ä»£ç å®¡æŸ¥åŠ©æ‰‹

```
éœ€æ±‚: å®¡æŸ¥ä»£ç ï¼Œæå‡ºæ”¹è¿›å»ºè®®
ç‰¹ç‚¹:
- éœ€è¦å¤šè§’åº¦è¯„ä¼°
- éœ€è¦é«˜è´¨é‡è¾“å‡º
- å¯ä»¥å¤šæ¬¡è¿­ä»£
- ä¸è¿½æ±‚æè‡´é€Ÿåº¦

é€‰æ‹©: ReflectionAgent âœ…
ç†ç”±: éœ€è¦æ·±åº¦æ€è€ƒå’Œå¤šæ¬¡æ”¹è¿›
```

---

### ğŸ“Š å®Œæ•´å¯¹æ¯”è¡¨

| ç»´åº¦ | Simple | ReAct | Reflection | PlanAndSolve |
|------|--------|-------|------------|--------------|
| **å“åº”æ—¶é—´** | 1-2s | 5-10s | 10-20s | 15-30s |
| **Tokenæ¶ˆè€—** | 100-500 | 500-2K | 1K-5K | 2K-10K |
| **æˆæœ¬** | $ | $$ | $$$ | $$$$ |
| **å‡†ç¡®ç‡** | 85% | 80% | 95% | 90% |
| **ç®€å•é—®ç­”** | âœ…âœ…âœ… | âŒ | âŒ | âŒ |
| **å·¥å…·è°ƒç”¨** | âŒ | âœ…âœ…âœ… | âœ… | âœ…âœ… |
| **ä»£ç ç”Ÿæˆ** | âœ… | âœ… | âœ…âœ…âœ… | âœ…âœ… |
| **æ•°æ®åˆ†æ** | âŒ | âœ…âœ… | âœ… | âœ…âœ…âœ… |
| **åˆ›æ„å†™ä½œ** | âœ…âœ… | âœ… | âœ…âœ…âœ… | âœ…âœ… |
| **è§„åˆ’ä»»åŠ¡** | âŒ | âœ… | âœ… | âœ…âœ…âœ… |
| **å®æ—¶å¯¹è¯** | âœ…âœ…âœ… | âœ…âœ… | âŒ | âŒ |

---

### ğŸ“š å®Œæ•´æ–‡æ¡£

è¯¦ç»†å¯¹æ¯”è§: [exercise_03_agent_comparison.md](../agent-langchain-code/HelloAgents_Chapter7_Code/exercises/exercise_03_agent_comparison.md)

---

## ä¹ é¢˜4: å·¥å…·å¼€å‘

### é¢˜ç›®

å®ç°ä¸€ä¸ªå®ç”¨çš„è‡ªå®šä¹‰å·¥å…·

åŸºäº LangChain çš„å·¥å…·æ¥å£ï¼Œå®ç°ä¸€äº›å®ç”¨çš„è‡ªå®šä¹‰å·¥å…·ï¼Œå¹¶é›†æˆåˆ° Agent ä¸­ä½¿ç”¨ã€‚

è¦æ±‚ï¼š
- å®ç°è‡³å°‘ 5 ä¸ªä¸åŒç±»å‹çš„å·¥å…·
- å·¥å…·è¦æœ‰å®é™…åº”ç”¨ä»·å€¼
- æä¾›å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹

---

### è§£ç­”4.1: å·¥å…·åˆ†ç±»å’Œè®¾è®¡

#### ğŸ“¦ å·¥å…·åˆ†ç±»

```
å·¥å…·åˆ†ç±»ä½“ç³»:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ–‡ä»¶æ“ä½œå·¥å…·                    â”‚
â”‚    â”œâ”€ FileReadTool (è¯»å–æ–‡ä»¶)     â”‚
â”‚    â”œâ”€ FileWriteTool (å†™å…¥æ–‡ä»¶)    â”‚
â”‚    â””â”€ FileListTool (åˆ—å‡ºç›®å½•)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. HTTP API å·¥å…·                  â”‚
â”‚    â”œâ”€ HTTPGetTool (GET è¯·æ±‚)      â”‚
â”‚    â””â”€ GitHubRepoTool (GitHub ä¿¡æ¯)â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. JSON å¤„ç†å·¥å…·                   â”‚
â”‚    â”œâ”€ ParseJSONTool (è§£æ JSON)   â”‚
â”‚    â””â”€ ExtractFieldTool (æå–å­—æ®µ) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. æ—¥æœŸæ—¶é—´å·¥å…·                    â”‚
â”‚    â”œâ”€ CurrentTimeTool (å½“å‰æ—¶é—´)  â”‚
â”‚    â”œâ”€ DateDiffTool (æ—¥æœŸå·®å€¼)     â”‚
â”‚    â””â”€ DateAddTool (æ—¥æœŸåŠ å‡)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. æ–‡æœ¬å¤„ç†å·¥å…·                    â”‚
â”‚    â”œâ”€ WordCountTool (ç»Ÿè®¡å­—æ•°)    â”‚
â”‚    â””â”€ TextTransformTool (æ–‡æœ¬è½¬æ¢)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### è§£ç­”4.2: æ–‡ä»¶æ“ä½œå·¥å…·å®ç°

#### ğŸ’» æ ¸å¿ƒä»£ç 

```python
from langchain_core.tools import BaseTool
from pathlib import Path
from typing import Optional

class FileReadTool(BaseTool):
    """è¯»å–æ–‡ä»¶å†…å®¹çš„å·¥å…·"""

    name: str = "read_file"
    description: str = """
    è¯»å–æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
    è¾“å…¥æ ¼å¼: æ–‡ä»¶è·¯å¾„ (å¦‚: /path/to/file.txt)
    è¿”å›: æ–‡ä»¶å†…å®¹æˆ–é”™è¯¯ä¿¡æ¯
    """

    def _run(self, file_path: str) -> str:
        """è¯»å–æ–‡ä»¶"""
        try:
            path = Path(file_path).expanduser()

            if not path.exists():
                return f"âŒ æ–‡ä»¶ä¸å­˜åœ¨: {file_path}"

            with open(path, 'r', encoding='utf-8') as f:
                content = f.read()

            return f"âœ… æˆåŠŸè¯»å–æ–‡ä»¶ ({len(content)} å­—ç¬¦):\n{content[:500]}"

        except Exception as e:
            return f"âŒ è¯»å–æ–‡ä»¶å¤±è´¥: {str(e)}"

    async def _arun(self, file_path: str) -> str:
        return self._run(file_path)


class FileWriteTool(BaseTool):
    """å†™å…¥æ–‡ä»¶å†…å®¹çš„å·¥å…·"""

    name: str = "write_file"
    description: str = """
    å°†å†…å®¹å†™å…¥æŒ‡å®šæ–‡ä»¶ã€‚
    è¾“å…¥æ ¼å¼: æ–‡ä»¶è·¯å¾„::å†…å®¹ (ç”¨::åˆ†éš”)
    ç¤ºä¾‹: /tmp/test.txt::Hello World
    """

    def _run(self, input_str: str) -> str:
        """å†™å…¥æ–‡ä»¶"""
        try:
            if "::" not in input_str:
                return "âŒ æ ¼å¼é”™è¯¯,è¯·ä½¿ç”¨: æ–‡ä»¶è·¯å¾„::å†…å®¹"

            file_path, content = input_str.split("::", 1)
            path = Path(file_path.strip()).expanduser()

            # åˆ›å»ºçˆ¶ç›®å½•
            path.parent.mkdir(parents=True, exist_ok=True)

            # å†™å…¥æ–‡ä»¶
            with open(path, 'w', encoding='utf-8') as f:
                f.write(content.strip())

            return f"âœ… æˆåŠŸå†™å…¥æ–‡ä»¶: {path} ({len(content)} å­—ç¬¦)"

        except Exception as e:
            return f"âŒ å†™å…¥æ–‡ä»¶å¤±è´¥: {str(e)}"

    async def _arun(self, input_str: str) -> str:
        return self._run(input_str)
```

#### ğŸ“ ä½¿ç”¨ç¤ºä¾‹

```python
# åˆ›å»ºå·¥å…·å®ä¾‹
write_tool = FileWriteTool()
read_tool = FileReadTool()

# å†™å…¥æ–‡ä»¶
result = write_tool.run("/tmp/test.txt::è¿™æ˜¯æµ‹è¯•å†…å®¹\nHello World!")
print(result)  # âœ… æˆåŠŸå†™å…¥æ–‡ä»¶: /tmp/test.txt (18 å­—ç¬¦)

# è¯»å–æ–‡ä»¶
result = read_tool.run("/tmp/test.txt")
print(result)
# âœ… æˆåŠŸè¯»å–æ–‡ä»¶ (18 å­—ç¬¦):
# è¿™æ˜¯æµ‹è¯•å†…å®¹
# Hello World!
```

---

### è§£ç­”4.3: HTTP API å·¥å…·å®ç°

#### ğŸ’» æ ¸å¿ƒä»£ç 

```python
from langchain_core.tools import tool
import requests
import json

@tool
def fetch_github_repo_info(repo: str) -> str:
    """
    è·å– GitHub ä»“åº“ä¿¡æ¯ã€‚

    è¾“å…¥ä»“åº“åç§° (æ ¼å¼: owner/repo)
    è¿”å›ä»“åº“çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚æ˜Ÿæ ‡æ•°ã€forkæ•°ç­‰ã€‚

    ç¤ºä¾‹: langchain-ai/langchain
    """
    try:
        url = f"https://api.github.com/repos/{repo}"
        response = requests.get(url, timeout=10)
        response.raise_for_status()

        data = response.json()

        result = f"""
ğŸ“¦ ä»“åº“: {data['full_name']}
ğŸ“ æè¿°: {data.get('description', 'æ— ')}
â­ Stars: {data['stargazers_count']}
ğŸ”± Forks: {data['forks_count']}
ğŸ‘€ Watchers: {data['watchers_count']}
ğŸ› Issues: {data['open_issues_count']}
ğŸ“… åˆ›å»ºæ—¶é—´: {data['created_at']}
ğŸ”„ æœ€åæ›´æ–°: {data['updated_at']}
ğŸ”— é“¾æ¥: {data['html_url']}
"""
        return result.strip()

    except Exception as e:
        return f"âŒ è·å–ä»“åº“ä¿¡æ¯å¤±è´¥: {str(e)}"
```

#### ğŸ“ ä½¿ç”¨ç¤ºä¾‹

```python
# è·å– LangChain ä»“åº“ä¿¡æ¯
result = fetch_github_repo_info.invoke("langchain-ai/langchain")
print(result)
# è¾“å‡º:
# ğŸ“¦ ä»“åº“: langchain-ai/langchain
# ğŸ“ æè¿°: âš¡ Building applications with LLMs...
# â­ Stars: 85000+
# ...
```

---

### è§£ç­”4.4: æ—¥æœŸæ—¶é—´å·¥å…·å®ç°

#### ğŸ’» æ ¸å¿ƒä»£ç 

```python
from langchain_core.tools import tool
from datetime import datetime, timedelta

@tool
def get_current_datetime() -> str:
    """
    è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´ã€‚
    è¿”å›å½“å‰çš„æ—¥æœŸã€æ—¶é—´ã€æ˜ŸæœŸç­‰ä¿¡æ¯ã€‚
    """
    now = datetime.now()
    weekdays = ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥']

    result = f"""
ğŸ“… å½“å‰æ—¥æœŸ: {now.strftime('%Yå¹´%mæœˆ%dæ—¥')}
ğŸ• å½“å‰æ—¶é—´: {now.strftime('%H:%M:%S')}
ğŸ“† æ˜ŸæœŸ: {weekdays[now.weekday()]}
â° æ—¶é—´æˆ³: {int(now.timestamp())}
"""
    return result.strip()


@tool
def calculate_date_diff(date_str: str) -> str:
    """
    è®¡ç®—æ—¥æœŸå·®å€¼ã€‚

    è¾“å…¥æ ¼å¼: YYYY-MM-DD (è®¡ç®—åˆ°ä»Šå¤©çš„å¤©æ•°å·®)
    ç¤ºä¾‹: 2024-01-01
    è¿”å›: è·ç¦»ä»Šå¤©çš„å¤©æ•°
    """
    try:
        target_date = datetime.strptime(date_str.strip(), '%Y-%m-%d')
        today = datetime.now().replace(hour=0, minute=0, second=0, microsecond=0)

        diff = target_date - today
        days = diff.days

        if days > 0:
            return f"ğŸ“… {date_str} æ˜¯ {days} å¤©å"
        elif days < 0:
            return f"ğŸ“… {date_str} æ˜¯ {abs(days)} å¤©å‰"
        else:
            return f"ğŸ“… {date_str} å°±æ˜¯ä»Šå¤©!"

    except ValueError:
        return "âŒ æ—¥æœŸæ ¼å¼é”™è¯¯,è¯·ä½¿ç”¨: YYYY-MM-DD"
```

#### ğŸ“ ä½¿ç”¨ç¤ºä¾‹

```python
# è·å–å½“å‰æ—¶é—´
result = get_current_datetime.invoke("")
print(result)
# è¾“å‡º:
# ğŸ“… å½“å‰æ—¥æœŸ: 2024å¹´01æœˆ27æ—¥
# ğŸ• å½“å‰æ—¶é—´: 14:30:00
# ğŸ“† æ˜ŸæœŸ: å‘¨å…­
# â° æ—¶é—´æˆ³: 1706337000

# è®¡ç®—æ—¥æœŸå·®å€¼
result = calculate_date_diff.invoke("2025-12-31")
print(result)
# è¾“å‡º: ğŸ“… 2025-12-31 æ˜¯ 339 å¤©å
```

---

### è§£ç­”4.5: ä¸ Agent é›†æˆ

#### ğŸ¤– å®Œæ•´ç¤ºä¾‹

```python
from core.utils import setup_llm
from agents.react_agent_langchain import ReActAgent
from tools.calculator_tool import CalculatorTool
from exercises.exercise_04_custom_tools import (
    get_current_datetime,
    calculate_date_diff,
    fetch_github_repo_info
)

# åˆ›å»ºå·¥å…·åˆ—è¡¨
tools = [
    CalculatorTool(),           # è®¡ç®—å™¨
    get_current_datetime,       # å½“å‰æ—¶é—´
    calculate_date_diff,        # æ—¥æœŸå·®å€¼
    fetch_github_repo_info,     # GitHub ä¿¡æ¯
]

# åˆ›å»º Agent
llm = setup_llm(model="glm-4-flash")
agent = ReActAgent(
    name="å·¥å…·ä¸“å®¶",
    llm=llm,
    tools=tools,
    max_iterations=5
)

# æµ‹è¯•ä»»åŠ¡
print("ğŸ’¬ ä»»åŠ¡1: è·å–å½“å‰æ—¶é—´")
result = agent.run("ç°åœ¨å‡ ç‚¹äº†?")
print(f"ç»“æœ: {result}\n")

print("ğŸ’¬ ä»»åŠ¡2: è®¡ç®—æ—¥æœŸ")
result = agent.run("è·ç¦» 2025 å¹´æ˜¥èŠ‚è¿˜æœ‰å¤šå°‘å¤©?")
print(f"ç»“æœ: {result}\n")

print("ğŸ’¬ ä»»åŠ¡3: GitHub ä¿¡æ¯")
result = agent.run("è·å– langchain-ai/langchain ä»“åº“çš„ä¿¡æ¯")
print(f"ç»“æœ: {result}\n")
```

---

### ğŸ“¦ å®Œæ•´ä»£ç 

å®Œæ•´å®ç°è§: [exercise_04_custom_tools.py](../agent-langchain-code/HelloAgents_Chapter7_Code/exercises/exercise_04_custom_tools.py)

è¿è¡Œæµ‹è¯•:
```bash
cd agent-langchain-code/HelloAgents_Chapter7_Code/exercises
python exercise_04_custom_tools.py
```

---

## ä¹ é¢˜5: ç³»ç»Ÿæ‰©å±• - æ’ä»¶ç³»ç»Ÿ

### é¢˜ç›®

è®¾è®¡æ’ä»¶ç³»ç»Ÿæ¶æ„

è®¾è®¡ä¸€ä¸ªå¯æ‰©å±•çš„æ’ä»¶ç³»ç»Ÿï¼Œæ”¯æŒåŠ¨æ€åŠ è½½æ’ä»¶ã€æ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€æ’ä»¶ä¾èµ–ç®¡ç†ç­‰åŠŸèƒ½ã€‚

è¦æ±‚ï¼š
- å®ç°æ’ä»¶çš„åŠ¨æ€åŠ è½½
- å®ç°æ’ä»¶çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†
- å®ç°æ’ä»¶çš„ä¾èµ–æ£€æŸ¥
- æä¾›ç¤ºä¾‹æ’ä»¶

---

### è§£ç­”5.1: æ’ä»¶ç³»ç»Ÿè®¾è®¡

#### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
æ’ä»¶ç³»ç»Ÿæ¶æ„:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       PluginManager (æ’ä»¶ç®¡ç†å™¨)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  + discover_plugins()                 â”‚
â”‚  + load_plugin()                      â”‚
â”‚  + initialize_all()                   â”‚
â”‚  + start_all()                        â”‚
â”‚  + stop_all()                         â”‚
â”‚  + execute_plugin()                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ ç®¡ç†
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                   â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚ Plugin A  â”‚  â”‚  Plugin B  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çŠ¶æ€ç®¡ç†   â”‚  â”‚  ä¾èµ–æ£€æŸ¥  â”‚
â”‚ ç”Ÿå‘½å‘¨æœŸ   â”‚  â”‚  åŠ¨æ€åŠ è½½  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ“Š æ’ä»¶ç”Ÿå‘½å‘¨æœŸ

```
æ’ä»¶ç”Ÿå‘½å‘¨æœŸçŠ¶æ€æœº:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UNLOADED â”‚ (æœªåŠ è½½)
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ load()
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LOADED  â”‚ (å·²åŠ è½½)
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ initialize()
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚INITIALIZED â”‚ (å·²åˆå§‹åŒ–)
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ start()
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STARTED  â”‚ (å·²å¯åŠ¨) â†â”€â”
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚
     â”‚ stop()           â”‚
     â†“                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ STOPPED  â”‚ (å·²åœæ­¢) â”€â”€â”˜
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ cleanup()
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UNLOADED â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### è§£ç­”5.2: æ ¸å¿ƒå®ç°

#### ğŸ’» æ’ä»¶çŠ¶æ€æšä¸¾

```python
from enum import Enum

class PluginState(Enum):
    """æ’ä»¶çŠ¶æ€"""
    UNLOADED = "unloaded"        # æœªåŠ è½½
    LOADED = "loaded"            # å·²åŠ è½½
    INITIALIZED = "initialized"   # å·²åˆå§‹åŒ–
    STARTED = "started"          # å·²å¯åŠ¨
    STOPPED = "stopped"          # å·²åœæ­¢
    ERROR = "error"              # é”™è¯¯çŠ¶æ€
```

#### ğŸ’» æ’ä»¶å…ƒæ•°æ®

```python
from dataclasses import dataclass, field
from typing import List, Dict, Any

@dataclass
class PluginMetadata:
    """æ’ä»¶å…ƒæ•°æ®"""
    name: str                    # æ’ä»¶åç§°
    version: str                 # ç‰ˆæœ¬å·
    description: str = ""        # æè¿°
    author: str = ""             # ä½œè€…
    dependencies: List[str] = field(default_factory=list)  # ä¾èµ–
    tags: List[str] = field(default_factory=list)          # æ ‡ç­¾
```

#### ğŸ’» æ’ä»¶åŸºç±»

```python
from abc import ABC, abstractmethod

class Plugin(ABC):
    """
    æ’ä»¶æŠ½è±¡åŸºç±»
    æ‰€æœ‰æ’ä»¶å¿…é¡»ç»§æ‰¿æ­¤ç±»
    """

    def __init__(self, config: Optional[Dict[str, Any]] = None):
        self.config = config or {}
        self.state = PluginState.LOADED

    @abstractmethod
    def get_metadata(self) -> PluginMetadata:
        """è·å–æ’ä»¶å…ƒæ•°æ®(å¿…é¡»å®ç°)"""
        pass

    def initialize(self) -> bool:
        """
        åˆå§‹åŒ–æ’ä»¶
        æ’ä»¶åŠ è½½åè°ƒç”¨
        """
        try:
            print(f"  ğŸ”§ åˆå§‹åŒ–æ’ä»¶: {self.get_metadata().name}")
            self.state = PluginState.INITIALIZED
            return True
        except Exception as e:
            print(f"  âŒ åˆå§‹åŒ–å¤±è´¥: {e}")
            self.state = PluginState.ERROR
            return False

    def start(self) -> bool:
        """
        å¯åŠ¨æ’ä»¶
        åˆå§‹åŒ–åè°ƒç”¨
        """
        try:
            print(f"  â–¶ï¸  å¯åŠ¨æ’ä»¶: {self.get_metadata().name}")
            self.state = PluginState.STARTED
            return True
        except Exception as e:
            print(f"  âŒ å¯åŠ¨å¤±è´¥: {e}")
            return False

    def stop(self) -> bool:
        """åœæ­¢æ’ä»¶"""
        try:
            print(f"  â¸ï¸  åœæ­¢æ’ä»¶: {self.get_metadata().name}")
            self.state = PluginState.STOPPED
            return True
        except Exception as e:
            print(f"  âŒ åœæ­¢å¤±è´¥: {e}")
            return False

    def cleanup(self):
        """æ¸…ç†æ’ä»¶èµ„æº"""
        try:
            print(f"  ğŸ§¹ æ¸…ç†æ’ä»¶: {self.get_metadata().name}")
            self.state = PluginState.UNLOADED
        except Exception as e:
            print(f"  âŒ æ¸…ç†å¤±è´¥: {e}")

    @abstractmethod
    def execute(self, *args, **kwargs) -> Any:
        """æ‰§è¡Œæ’ä»¶åŠŸèƒ½(å¿…é¡»å®ç°)"""
        pass
```

---

### è§£ç­”5.3: æ’ä»¶ç®¡ç†å™¨

#### ğŸ’» æ ¸å¿ƒå®ç°

```python
import importlib
import inspect
from pathlib import Path

class PluginManager:
    """æ’ä»¶ç®¡ç†å™¨ - è´Ÿè´£æ’ä»¶çš„åŠ è½½ã€ç®¡ç†å’Œæ‰§è¡Œ"""

    def __init__(self, plugin_dirs: Optional[List[str]] = None):
        self.plugin_dirs = plugin_dirs or []
        self.plugins: Dict[str, Plugin] = {}
        print("ğŸ”Œ æ’ä»¶ç®¡ç†å™¨å·²åˆå§‹åŒ–")

    def discover_plugins(self) -> List[str]:
        """å‘ç°æ‰€æœ‰å¯ç”¨çš„æ’ä»¶"""
        plugin_files = []

        for plugin_dir in self.plugin_dirs:
            path = Path(plugin_dir)
            if not path.exists():
                continue

            # æŸ¥æ‰¾æ‰€æœ‰ .py æ–‡ä»¶
            for file in path.glob("*.py"):
                if not file.name.startswith("_"):
                    plugin_files.append(str(file))

        print(f"ğŸ” å‘ç° {len(plugin_files)} ä¸ªæ’ä»¶æ–‡ä»¶")
        return plugin_files

    def load_plugin(self, plugin_path: str) -> bool:
        """åŠ¨æ€åŠ è½½å•ä¸ªæ’ä»¶"""
        try:
            # åŠ¨æ€å¯¼å…¥æ¨¡å—
            spec = importlib.util.spec_from_file_location(
                "plugin_module", plugin_path
            )
            module = importlib.util.module_from_spec(spec)
            spec.loader.exec_module(module)

            # æŸ¥æ‰¾ Plugin å­ç±»
            plugin_class = None
            for name, obj in inspect.getmembers(module):
                if (inspect.isclass(obj) and
                    issubclass(obj, Plugin) and
                    obj is not Plugin):
                    plugin_class = obj
                    break

            if not plugin_class:
                print(f"âš ï¸  æœªæ‰¾åˆ°æ’ä»¶ç±»: {plugin_path}")
                return False

            # å®ä¾‹åŒ–æ’ä»¶
            plugin_instance = plugin_class()
            metadata = plugin_instance.get_metadata()

            # æ£€æŸ¥ä¾èµ–
            if not self._check_dependencies(metadata):
                print(f"âŒ æ’ä»¶ä¾èµ–ä¸æ»¡è¶³: {metadata.name}")
                return False

            # æ³¨å†Œæ’ä»¶
            self.plugins[metadata.name] = plugin_instance
            print(f"âœ… åŠ è½½æ’ä»¶: {metadata.name} v{metadata.version}")
            return True

        except Exception as e:
            print(f"âŒ åŠ è½½æ’ä»¶å¤±è´¥: {e}")
            return False

    def _check_dependencies(self, metadata: PluginMetadata) -> bool:
        """æ£€æŸ¥æ’ä»¶ä¾èµ–"""
        for dep in metadata.dependencies:
            if dep not in self.plugins:
                print(f"  âš ï¸  ç¼ºå°‘ä¾èµ–: {dep}")
                return False
        return True

    def initialize_all(self) -> bool:
        """åˆå§‹åŒ–æ‰€æœ‰æ’ä»¶"""
        print("\nğŸ”§ åˆå§‹åŒ–æ‰€æœ‰æ’ä»¶...")
        success = True

        for name, plugin in self.plugins.items():
            if not plugin.initialize():
                success = False

        return success

    def start_all(self) -> bool:
        """å¯åŠ¨æ‰€æœ‰æ’ä»¶"""
        print("\nâ–¶ï¸  å¯åŠ¨æ‰€æœ‰æ’ä»¶...")
        success = True

        for name, plugin in self.plugins.items():
            if not plugin.start():
                success = False

        return success

    def execute_plugin(self, name: str, *args, **kwargs) -> Any:
        """æ‰§è¡ŒæŒ‡å®šæ’ä»¶"""
        plugin = self.plugins.get(name)

        if not plugin:
            raise ValueError(f"æ’ä»¶ä¸å­˜åœ¨: {name}")

        if plugin.state != PluginState.STARTED:
            raise RuntimeError(f"æ’ä»¶æœªå¯åŠ¨: {name}")

        return plugin.execute(*args, **kwargs)
```

---

### è§£ç­”5.4: ç¤ºä¾‹æ’ä»¶

#### ğŸ’» é—®å€™æ’ä»¶

```python
class GreetingPlugin(Plugin):
    """é—®å€™æ’ä»¶ - å¤šè¯­è¨€é—®å€™"""

    def get_metadata(self) -> PluginMetadata:
        return PluginMetadata(
            name="greeting",
            version="1.0.0",
            description="æä¾›å¤šè¯­è¨€é—®å€™åŠŸèƒ½",
            author="LangChain Team",
            tags=["greeting", "i18n"]
        )

    def execute(self, name: str = "World", lang: str = "en") -> str:
        """
        ç”Ÿæˆé—®å€™è¯­

        Args:
            name: åå­—
            lang: è¯­è¨€ (en/zh/es/fr)
        """
        greetings = {
            "en": f"Hello, {name}!",
            "zh": f"ä½ å¥½,{name}!",
            "es": f"Â¡Hola, {name}!",
            "fr": f"Bonjour, {name}!",
        }
        return greetings.get(lang, greetings["en"])
```

#### ğŸ’» è®¡ç®—å™¨æ’ä»¶

```python
class CalculatorPlugin(Plugin):
    """è®¡ç®—å™¨æ’ä»¶"""

    def get_metadata(self) -> PluginMetadata:
        return PluginMetadata(
            name="calculator",
            version="1.0.0",
            description="æä¾›åŸºæœ¬è®¡ç®—åŠŸèƒ½",
            author="LangChain Team",
            tags=["math", "calculator"]
        )

    def execute(self, expression: str) -> str:
        """è®¡ç®—æ•°å­¦è¡¨è¾¾å¼"""
        try:
            result = eval(expression, {"__builtins__": {}}, {})
            return f"{expression} = {result}"
        except Exception as e:
            return f"è®¡ç®—é”™è¯¯: {e}"
```

---

### è§£ç­”5.5: ä½¿ç”¨ç¤ºä¾‹

#### ğŸ’» å®Œæ•´ç¤ºä¾‹

```python
# åˆ›å»ºæ’ä»¶ç®¡ç†å™¨
manager = PluginManager()

# æ‰‹åŠ¨æ³¨å†Œæ’ä»¶
print("\nğŸ“¦ æ³¨å†Œæ’ä»¶...")
manager.plugins["greeting"] = GreetingPlugin()
manager.plugins["calculator"] = CalculatorPlugin()

# åˆå§‹åŒ–å’Œå¯åŠ¨
manager.initialize_all()
manager.start_all()

# æ‰§è¡Œæ’ä»¶
print("\nğŸ¯ æ‰§è¡Œæ’ä»¶...")
print("1. Greeting:")
result = manager.execute_plugin('greeting', name='Alice', lang='zh')
print(f"   {result}")

print("2. Calculator:")
result = manager.execute_plugin('calculator', '2 + 3 * 4')
print(f"   {result}")

# åˆ—å‡ºæ‰€æœ‰æ’ä»¶
print("\nğŸ“‹ æ’ä»¶åˆ—è¡¨:")
for name, plugin in manager.plugins.items():
    metadata = plugin.get_metadata()
    print(f"  - {name} v{metadata.version} ({plugin.state.value})")

# æ¸…ç†
manager.stop_all()
manager.cleanup_all()
```

---

### ğŸ’¡ æ‰©å±•æ€è€ƒ

1. **å¦‚ä½•å®ç°æ’ä»¶çƒ­åŠ è½½?**
   - æç¤º: ç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè‡ªåŠ¨é‡æ–°åŠ è½½
   - æç¤º: ä¿å­˜æ’ä»¶çŠ¶æ€ï¼Œé‡è½½åæ¢å¤

2. **å¦‚ä½•å®ç°æ’ä»¶ç‰ˆæœ¬ç®¡ç†?**
   - æç¤º: æ”¯æŒå¤šç‰ˆæœ¬å…±å­˜
   - æç¤º: è¯­ä¹‰åŒ–ç‰ˆæœ¬æ£€æŸ¥

3. **å¦‚ä½•å®ç°æ’ä»¶é€šä¿¡?**
   - æç¤º: äº‹ä»¶æ€»çº¿ (Pub-Sub)
   - æç¤º: æ’ä»¶é—´æ¥å£è°ƒç”¨

4. **å¦‚ä½•å®ç°æ’ä»¶å®‰å…¨æ²™ç®±?**
   - æç¤º: èµ„æºé™åˆ¶ (å†…å­˜ã€CPU)
   - æç¤º: æƒé™æ§åˆ¶

5. **å¦‚ä½•è®¾è®¡æ’ä»¶å¸‚åœº?**
   - æç¤º: æ’ä»¶å‘å¸ƒã€ä¸‹è½½ã€è¯„åˆ†
   - æç¤º: è‡ªåŠ¨æ›´æ–°æœºåˆ¶

---

### ğŸ“¦ å®Œæ•´ä»£ç 

å®Œæ•´å®ç°è§: [exercise_05_plugin_system.py](../agent-langchain-code/HelloAgents_Chapter7_Code/exercises/exercise_05_plugin_system.py)

è¿è¡Œæµ‹è¯•:
```bash
cd agent-langchain-code/HelloAgents_Chapter7_Code/exercises
python exercise_05_plugin_system.py
```

---

## ğŸ‰ æ€»ç»“

é€šè¿‡å®Œæˆè¿™äº”é“ä¹ é¢˜ï¼Œæˆ‘ä»¬æ·±å…¥å­¦ä¹ äº†ï¼š

### ç†è®ºå±‚é¢
- âœ… æ¡†æ¶è®¾è®¡ç†å¿µ ("ä¸‡ç‰©çš†å·¥å…·"çš„ä¼˜ç¼ºç‚¹)
- âœ… Agent æ¶æ„å¯¹æ¯” (4 ç§ Agent çš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯)
- âœ… ç³»ç»Ÿæ¶æ„è®¾è®¡ (æ’ä»¶ç³»ç»Ÿçš„å®Œæ•´è®¾è®¡)

### å®è·µå±‚é¢
- âœ… å¤šæ¨¡å‹æ”¯æŒ (ç»Ÿä¸€æ¥å£ç®¡ç†å¤šä¸ª LLM æä¾›å•†)
- âœ… è‡ªå®šä¹‰å·¥å…·å¼€å‘ (5 ç±» 10+ ä¸ªå®ç”¨å·¥å…·)
- âœ… æ’ä»¶ç³»ç»Ÿå®ç° (ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€åŠ¨æ€åŠ è½½ã€ä¾èµ–æ£€æŸ¥)

### å·¥ç¨‹èƒ½åŠ›
- âœ… ç³»ç»ŸæŠ½è±¡èƒ½åŠ›
- âœ… æ¥å£è®¾è®¡èƒ½åŠ›
- âœ… æ‰©å±•æ€§è®¾è®¡
- âœ… æ¨¡å—åŒ–æ€ç»´

---

## ğŸ“š ç›¸å…³èµ„æº

- **ä¹ é¢˜ä»£ç **: [exercises/](../agent-langchain-code/HelloAgents_Chapter7_Code/exercises/)
- **è¿è¡Œè„šæœ¬**: [run_all_exercises.py](../agent-langchain-code/HelloAgents_Chapter7_Code/exercises/run_all_exercises.py)
- **ä¹ é¢˜æ€»ç»“**: [EXERCISES_SUMMARY.md](../agent-langchain-code/HelloAgents_Chapter7_Code/EXERCISES_SUMMARY.md)

---

**Happy Coding! ğŸš€**

*æœ€åæ›´æ–°: 2025-01-27*
